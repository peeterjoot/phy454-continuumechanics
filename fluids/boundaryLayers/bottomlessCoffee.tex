%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\makeproblem{Spin down of coffee in a bottomless cup}{problem:fluids:bottomlessCoffee}{
Here is a variation of a problem outlined in \S 2 of \citep{acheson1990elementary}, which looked at the time evolution of fluid with initial rotational motion, after the (cylindrical) rotation driver stops, later describing this as the spin down of a cup of tea.  I will work the problem in more detail than in the text, and also make two refinements.

\begin{enumerate}
\item I drink coffee and not tea.
\item I stir my coffee in the interior of the cup and not on the outer edge.
\end{enumerate}

Because of the second point I will model my stir stick as a rotating cylinder in the cup and not by somebody spinning the cup itself to stir the tea.  This only changes the solution for the steady state part of the problem.
} % makeproblem

\makeanswer{problem:fluids:bottomlessCoffee}{
We will work in cylindrical coordinates following the conventions of \cref{fig:coffeeCupDiagram:coffeeCupDiagramFig1}.

\imageFigure{../../figures/phy454/bottomlessCoffeeFluid_flow_in_nested_cylindersFig1}{Fluid flow in nested cylinders}{fig:coffeeCupDiagram:coffeeCupDiagramFig1}{0.3}

We will assume a solution that with velocity azimuthal in direction, and both pressure and velocity that are only radially dependent.

\begin{equation}\label{eqn:bottomlessCoffee:10}
\Bu = u(r) \phicap.
\end{equation}
\begin{equation}\label{eqn:bottomlessCoffee:30}
p = p(r)
\end{equation}

Let us first verify that this meets the non-compressible condition that eliminates the \(\mu \spacegrad (\spacegrad \cdot \Bu)\) term from Navier-Stokes

\begin{equation}\label{eqn:bottomlessCoffee:590}
\begin{aligned}
\spacegrad \cdot \Bu
&=
\left(\rcap \partial_r + \frac{\phicap}{r} \partial_\phi + \zcap \partial_z\right) \cdot \left(u \phicap\right) \\
&=
\phicap \cdot
\left(\rcap \partial_r u + \frac{\phicap}{r} \partial_\phi u + \zcap \partial_z u\right)
+
u
\left(\rcap \cdot \partial_r \phicap + \frac{\phicap}{r} \cdot \partial_\phi \phicap + \zcap \cdot \partial_z \phicap\right)  \\
&=
\phicap \cdot \rcap \partial_r u
+
u
\frac{\phicap}{r} \cdot \left(-\rcap\right) \\
&= 0.
\end{aligned}
\end{equation}

Good.  Now let us express each of the terms of Navier-Stokes in cylindrical form.  Our time dependence is

\begin{equation}\label{eqn:bottomlessCoffee:50}
\rho \partial_t u(r, t) \phicap
=
\rho \phicap \partial_t u.
\end{equation}

Our inertial term is


\begin{dmath}\label{eqn:bottomlessCoffee:70}
\rho (\Bu \cdot \spacegrad) \Bu
=
\frac{\rho u}{r} \partial_\phi (u \phicap)
=
\frac{\rho u^2}{r} (-\rcap).
\end{dmath}

Our pressure term is

\begin{equation}\label{eqn:bottomlessCoffee:90}
-\spacegrad p
=
-\rcap \partial_r p,
\end{equation}

and our Laplacian term is


\begin{dmath}\label{eqn:bottomlessCoffee:110}
\mu \spacegrad^2 \Bu
=
\mu \left(
\inv{r} \partial_r ( r \partial_r) + \inv{r^2} \partial_{\phi\phi} + \partial_{z z}
\right)
u(r) \phicap
=
\mu \left(
\frac{\phicap}{r} \partial_r ( r \partial_r u) + \frac{-\rcap u}{r^2}
\right).
\end{dmath}

Putting things together, we find that Navier-Stokes takes the form

\begin{equation}\label{eqn:bottomlessCoffee:130}
\rho \phicap \partial_t u
+
\frac{\rho u^2}{r} (-\rcap)
=
-\rcap \partial_r p
+
\mu \left(
\frac{\phicap}{r} \partial_r ( r \partial_r u) + \frac{-\phicap u}{r^2}
\right),
\end{equation}

which nicely splits into an separate equations for the \(\phicap\) and \(\rcap\) directions respectively

\begin{subequations}
\begin{equation}\label{eqn:bottomlessCoffee:150}
\inv{\nu} \partial_t u
=
\frac{1}{r} \partial_r ( r \partial_r u)
- \frac{u}{r^2}
\end{equation}
\begin{equation}\label{eqn:bottomlessCoffee:170}
\frac{\rho u^2}{r}
=
\partial_r p.
\end{equation}
\end{subequations}

%\unnumberedSubsection{Steady state solution}

Before \(t = 0\) we seek the steady state, the solution of

\begin{equation}\label{eqn:bottomlessCoffee:190}
r \partial_r ( r \partial_r u) - u = 0.
\end{equation}

We have seen that

\begin{equation}\label{eqn:bottomlessCoffee:210}
u(r) = A r + \frac{B}{r}
\end{equation}

is the general solution, and can now fit this to the boundary value constraints.  For the interior portion of the cup we have

\begin{equation}\label{eqn:bottomlessCoffee:230}
\evalbar{A r + \frac{B}{r}}{r = 0} = 0
\end{equation}

so \(B = 0\) is required.  For the interface of the ``stir-stick'' (moving fast enough that we can consider it having a cylindrical effect) at \(r = R_1\) we have

\begin{equation}\label{eqn:bottomlessCoffee:250}
A R_1 = \Omega R_1,
\end{equation}

so the interior portion of our steady state coffee velocity is just

\begin{equation}\label{eqn:bottomlessCoffee:270}
\Bu = \Omega r \phicap.
\end{equation}

Between the cup edge and the stir-stick we have to solve

\begin{equation}\label{eqn:bottomlessCoffee:290}
\begin{aligned}
A R_1 + \frac{B}{R_1} &= \Omega R_1 \\
A R_2 + \frac{B}{R_2} &= 0,
\end{aligned}
\end{equation}

or
\begin{equation}\label{eqn:bottomlessCoffee:310}
\begin{aligned}
A R_1^2 + B &= \Omega R_1^2 \\
A R_2^2 + B &= 0.
\end{aligned}
\end{equation}

Subtracting we find

\begin{subequations}
\begin{equation}\label{eqn:bottomlessCoffee:330}
A = -\frac{\Omega R_1^2}{R_2^2 - R_1^2}
\end{equation}
\begin{equation}\label{eqn:bottomlessCoffee:350}
B = \frac{\Omega R_1^2 R_2^2}{R_2^2 - R_1^2},
\end{equation}
\end{subequations}

so our steady state coffee flow is
\begin{equation}\label{eqn:bottomlessCoffee:370}
\Bu =
\left\{
\begin{array}{l l}
\Omega r \phicap
& \quad \mbox{\(r \in [0, R_1]\)} \\
\frac{\Omega R_1^2}{R_2^2 - R_1^2}
\left(
\frac{R_2^2}{r} -r
\right)
\phicap
& \quad \mbox{\(r \in [R_1, R_2]\)} \\
\end{array}
\right.
\end{equation}

%\unnumberedSubsection{Time evolution}

We can use a separation of variables technique with \(u(r, t) = R(r) T(t)\) to find the time evolution

\begin{equation}\label{eqn:bottomlessCoffee:390}
\inv{\nu} \frac{T'}{T} =
\inv{R} \left(
\frac{1}{r} \partial_r ( r \partial_r R)
- \frac{R}{r^2}
\right)
= -\lambda^2,
\end{equation}

which gives us

\begin{equation}\label{eqn:bottomlessCoffee:410}
T \propto e^{-\lambda^2 \nu t},
\end{equation}

and \(R\) specified by

\begin{equation}\label{eqn:bottomlessCoffee:430}
0 = r^2 \frac{d^2 R}{dr^2} + r \frac{d R}{dr} + R \left( r^2 \lambda^2 - 1 \right).
\end{equation}

Checking \citep{abramowitz1964handbook} (9.1.1) we see that this can be put into the standard form of the Bessel equation if we eliminate the \(\lambda\) term.  We can do that writing \(z = r \lambda\), \(\calR(z) = R(z/\lambda)\) and noting that \(r d/dr = z d/dz\) and \(r^2 d^2/dr^2 = z^2 d^2/dz^2\), which gives us

\begin{equation}\label{eqn:bottomlessCoffee:450}
0 = z^2 \frac{d^2 \calR}{dr^2} + z \frac{d \calR}{dr} + \calR \left( z^2 - 1 \right).
\end{equation}

The solutions are

\begin{equation}\label{eqn:bottomlessCoffee:470}
\calR(z) = J_{\pm 1}(z), Y_{\pm 1}(z).
\end{equation}

From (9.1.5) of the handbook we see that the plus and minus variations are linearly dependent since \(J_{-1}(z) = -J_1(z)\) and \(Y_{-1}(z) = -Y_1(z)\), and from (9.1.8) that \(Y_1(z)\) is infinite at the origin, so our general solution has to be of the form

\begin{equation}\label{eqn:bottomlessCoffee:490}
\Bu(r, t) = \phicap \sum_\lambda c_\lambda e^{-\lambda^2 \nu t} J_{1}(r \lambda).
\end{equation}

In the text, I see that the transformation \(\lambda \rightarrow \lambda/a\) (where \(a\) was the radius of the cup) is made so that the Bessel function parameter was dimensionless.  We can do that too but write

\begin{equation}\label{eqn:bottomlessCoffee:490b}
\Bu(r, t) = \phicap \sum_\lambda c_\lambda e^{-\frac{\lambda^2}{R_2^2} \nu t} J_{1}\left(\lambda \frac{r}{R_2}\right).
\end{equation}

Our boundary value constraint is that we require this to match \eqnref{eqn:bottomlessCoffee:370} at \(t = 0\).  Let us write \(R_2 = R\), \(R_1 = a R\), \(z = r/R\), so that we are working in the unit circle with \(z \in [0, 1]\).  Our boundary problem can now be expressed as

\begin{equation}\label{eqn:bottomlessCoffee:490c}
\inv{\Omega R} \sum_\lambda c_\lambda J_{1}\left(\lambda z\right)
=
\left\{
\begin{array}{l l}
z
& \quad \mbox{\(z \in [0, a]\)} \\
\frac{1}{\frac{R^2}{a^2} - 1}
\left(
\inv{z} - z
\right)
& \quad \mbox{\(z \in [a, 1]\)} \\
\end{array}
\right.
\end{equation}

Let us pull the \(\Omega R\) factor into \(c_\lambda\) and state the problem to be solved as

\begin{subequations}
\begin{equation}\label{eqn:bottomlessCoffee:510}
\Bu(r, t) = \Omega R \phicap \sum_{i=1}^n c_i e^{-\frac{\lambda_i^2}{R^2} \nu t} J_{1}\left(\lambda_i \frac{r}{R}\right)
\end{equation}
\begin{equation}\label{eqn:bottomlessCoffee:530}
\sum_{i = 1}^n c_i J_{1}\left(\lambda_i z\right) = \phi(z)
\end{equation}
\begin{equation}\label{eqn:bottomlessCoffee:550}
\phi(z) =
\left\{
\begin{array}{l l}
z
& \quad \mbox{\(z \in [0, a]\)} \\
\frac{a^2}{1 - a^2}
\left(
\inv{z} - z
\right)
& \quad \mbox{\(z \in [a, 1]\)} \\
\end{array}
\right..
\end{equation}
\end{subequations}

Looking at \S 2.7 of \citep{sagan1989boundary} it appears the solutions for \(c_i\) can be obtained from

\begin{equation}\label{eqn:bottomlessCoffee:570}
c_i = \frac{
\int_0^1 z\phi(z) J_1(\lambda_i z) dz}{
\int_0^1 z J_1^2(\lambda_i z) dz},
\end{equation}

where \(\lambda_i\) are the zeros of \(J_1\).

To get a feel for these, a plot of the first few of these fitting functions is shown in \cref{fig:bottomlessCoffee:bottomlessCoffeeFig3}.

\imageFigure{../../figures/phy454/bottomlessCoffeeFirst_four_zero_crossing_Bessel_functions_J_1_lambda_i_zFig3}{First four zero crossing Bessel functions \(J_1( \lambda_i z)\)}{fig:bottomlessCoffee:bottomlessCoffeeFig3}{0.2}

Using Mathematica (\nbref{bottomlessCoffee.cdf}), these coefficients were calculated for \(a = 0.6\).  The \(n = 1, 3, 5\) approximations to the fitting function are plotted with a comparison to the steady state velocity profile in \cref{fig:bottomlessCoffee:bottomlessCoffeeFig2}.

\imageFigure{../../figures/phy454/bottomlessCoffeeBessel_function_fitting_for_the_steady_state_velocity_profile_for_n_1_3_5Fig2}{Bessel function fitting for the steady state velocity profile for \(n = 1, 3, 5\)}{fig:bottomlessCoffee:bottomlessCoffeeFig2}{0.2}

As indicated in the text, the spin down is way too slow to match reality (this can be seen visually in the worksheet by animating it).
} % end answer
