%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%

%
%
\label{chap:continuumL20}

\section{Asymptotic solutions of ill conditioned equations}

We will consider two cases, both ones that we can solve exactly

\begin{enumerate}
\item With \(u(0) = 1\), and letting \(\epsilon \rightarrow 0\), we will look at solutions of the ill conditioned LDE

\begin{equation}\label{eqn:continuumL20:10}
\epsilon \frac{du}{dy} + u = y
\end{equation}

\item With \(u(0) = 0\), \(u(1) = 2\), and \(0 < \epsilon \ll 1\) we will look at the second order ill conditioned LDE

\begin{equation}\label{eqn:continuumL20:30}
\epsilon \frac{d^2u}{dy^2} + \frac{du}{dy} = 1
\end{equation}
\end{enumerate}

\makeexample{First order LDE}{ex:singularPertubation:firstorder}{
%\unnumberedSubsection{Exact solution}
We can solve this system exactly.  Our homogeneous equation is

\begin{equation}\label{eqn:continuumL20:370}
\epsilon \frac{du}{dy} + u = 0,
\end{equation}

with solution

\begin{equation}\label{eqn:continuumL20:390}
u \propto e^{-y/\epsilon}.
\end{equation}

Looking for a solution of the form

\begin{equation}\label{eqn:continuumL20:410}
u = A(y) e^{-y/\epsilon},
\end{equation}

we find

\begin{equation}\label{eqn:continuumL20:430}
\epsilon A' e^{-y/\epsilon} = y,
\end{equation}

and integrate to find

\begin{equation}\label{eqn:continuumL20:450}
A(y) = (y - \epsilon) e^{x/\epsilon} + C.
\end{equation}

Application of the boundary value constraints give us

\begin{equation}\label{eqn:continuumL20:50}
u = ( 1 + \epsilon ) e^{-y/\epsilon} + y - \epsilon.
\end{equation}

This is plotted in \cref{fig:continuumL20:continuumL20Fig1}
\imageFigure{../../figures/phy454/lec20_Plot_of_exact_solution_to_simple_first_order_ill_conditioned_LDEFig1}{Plot of exact solution to simple first order ill conditioned LDE}{fig:continuumL20:continuumL20Fig1}{0.3}

%\unnumberedSubsection{Limiting cases}
We want to consider the limiting case where
\begin{equation}\label{eqn:continuumL20:70}
0 < \epsilon \ll 1,
\end{equation}

and we let \(\epsilon \rightarrow 0\).  If \(y = O(1)\), then we have

\begin{equation}\label{eqn:continuumL20:470}
u \approx 1 \times 0 + y,
\end{equation}

or just

\begin{equation}\label{eqn:continuumL20:490}
u = y.
\end{equation}

However, if \(y = O(\epsilon)\) then we have to be more careful constructing an approximation.  When \(y\) is very small, but \(\epsilon\) is also of the same order of smallness we have

\begin{equation}\label{eqn:continuumL20:130}
e^{-y/\epsilon} \ne 0.
\end{equation}

If \(\epsilon \rightarrow 0\) and \(y \rightarrow O(\epsilon)\)

\begin{equation}\label{eqn:continuumL20:150}
e^{-y/\epsilon} \rightarrow e^{-\epsilon O(1) /\epsilon} \rightarrow e^{-O(1)}
\end{equation}

so

\begin{equation}\label{eqn:continuumL20:170}
u \approx e^{-y/\epsilon}
\end{equation}

%\unnumberedSubsection{Approximate solution in the inner region}
For an approximate solution in the inner region, when \(y = O(\epsilon)\) define a new scale

\begin{equation}\label{eqn:continuumL20:190}
Y = \frac{y}{\epsilon}
\end{equation}

\begin{equation}\label{eqn:continuumL20:210}
y = O(1)
\end{equation}

so that our LDE takes the form

\begin{equation}\label{eqn:continuumL20:230}
\frac{du}{dY} + u = \epsilon Y
\end{equation}

When \(\epsilon \rightarrow 0\) we have

\begin{equation}\label{eqn:continuumL20:250}
\frac{du}{dY} + u \approx 0.
\end{equation}

We have solution

\begin{equation}\label{eqn:continuumL20:270}
\ln u = -Y + \ln C,
\end{equation}

or

\begin{equation}\label{eqn:continuumL20:290}
u \propto e^{-Y} = e^{-y/\epsilon}.
\end{equation}

%\FIXME{
%\unnumberedSubsection{Question:} Could not we just Laplace transform.
%\unnumberedSubsection{Answer given:} We would still get into trouble when we take \(\epsilon \rightarrow 0\).  My comment: I do not think that is strictly true.  In an example like this where we have an exact solution, a Laplace transform technique should also yield that solution.  I think the real trouble will come when we attempt to incorporate the non-linear inertial terms of the Navier-Stokes equation.
%}
} % end example

\makeexample{Second order example}{ex:singularPertubation:secondorder}{

%\unnumberedSubsection{Exact solution}
We can also solve this system exactly.  We saw above in the first order system that our specific solution was polynomial.  While that was found by the method of variation of parameters, it seems obvious in retrospect.  Let us start by looking for such a solution, starting with a first order polynomial

\begin{equation}\label{eqn:continuumL20:510}
u = A y + B.
\end{equation}

Application of our LDE operator on this produces

\begin{equation}\label{eqn:asymptoticSolutions:910}
\begin{aligned}
A &= 1 \\
B &= 0.
\end{aligned}
\end{equation}

Now let us move on to find a solution to the homogeneous equation

\begin{equation}\label{eqn:continuumL20:30b}
\epsilon \frac{d^2u}{dy^2} + \frac{du}{dy} = 0
\end{equation}

As usual, we look for the characteristic equation by assuming a solution of the form \(u = e^{m y}\).  This gives us

\begin{equation}\label{eqn:continuumL20:530}
\epsilon m^2 + m = (\epsilon m + 1) m = 0,
\end{equation}

with roots

\begin{equation}\label{eqn:continuumL20:550}
m = 0, -1/\epsilon.
\end{equation}

So our homogeneous equation has the form

\begin{equation}\label{eqn:continuumL20:570}
u(y) = A e^{-y/\epsilon} + B,
\end{equation}

and our full solution is

\begin{equation}\label{eqn:continuumL20:590}
u(y) = A e^{-y/\epsilon} + B + y
\end{equation}

with the constants \(A\) and \(B\) to be determined from our boundary value conditions.  We find

\begin{equation}\label{eqn:asymptoticSolutions:930}
\begin{aligned}
0 &= u(0) = A + B + 0 \\
2 &= u(1) = A e^{-1/\epsilon} + B + 1.
\end{aligned}
\end{equation}

We have got \(B = -A\) and by subtracting

\begin{equation}\label{eqn:continuumL20:610}
A ( e^{-1/\epsilon} -1 ) = 1.
\end{equation}

So the exact solution is

\begin{equation}\label{eqn:continuumL20:310}
u = y + \frac{e^{-y/\epsilon} - 1}{e^{1/\epsilon} - 1}.
\end{equation}

This is plotted in \cref{fig:continuumL20:continuumL20Fig2}
\imageFigure{../../figures/phy454/lec20_Plot_of_our_ill_conditioned_second_order_LDEFig2}{Plot of our ill conditioned second order LDE}{fig:continuumL20:continuumL20Fig2}{0.3}

%\unnumberedSubsection{Solution in the regular region}
Looking for a solution in the regular region, we consider small \(\epsilon\) relative to \(y\).  There our LDE is approximately

\begin{equation}\label{eqn:continuumL20:630}
\frac{du}{dy} = 1,
\end{equation}

which has solution
\begin{equation}\label{eqn:continuumL20:650}
u = y + C
\end{equation}

Our \(u(1) = 2\) boundary value constraint gives us

\begin{equation}\label{eqn:continuumL20:670}
C = 1.
\end{equation}

Our solution in the regular region where \(\epsilon \rightarrow 0\) and \(y = O(1)\) is therefore just

\begin{equation}\label{eqn:continuumL20:690}
u = y + 1.
\end{equation}

%\unnumberedSubsection{Solution in the ill conditioned region}
Now let us consider the inner (ill conditioned) region.  We will see below that when \(y = O(\epsilon)\), and we allow both \(\epsilon\) and \(y\) tend to zero independently, we have approximately

\begin{equation}\label{eqn:continuumL20:350}
u \sim 1 - e^{-y/\epsilon}.
\end{equation}

We will now show this.  We start with a helpful change of variables as we did in the first order case

\begin{equation}\label{eqn:continuumL20:710}
Y = \frac{y}{\epsilon}.
\end{equation}

When \(y = O(\epsilon)\) and \(Y = O(1)\) we have

\begin{equation}\label{eqn:continuumL20:730}
\cancel{\epsilon} \frac{d^2 u}{\cancel{\epsilon} \epsilon dY^2} + \inv{\epsilon} \frac{du}{dY} = 1
\end{equation}

or
\begin{equation}\label{eqn:continuumL20:750}
\frac{d^2 u}{dY^2} + \frac{du}{dY} = \epsilon.
\end{equation}

This puts the LDE into a non ill conditioned form, and allows us to let \(\epsilon \rightarrow 0\).  We have approximately

\begin{equation}\label{eqn:continuumL20:770}
\frac{d^2 u}{dY^2} + \frac{du}{dY} = 0.
\end{equation}

We have solved this in our exact solution work above (in a slightly more general form), and thus in this case we have just

\begin{equation}\label{eqn:continuumL20:830}
u = A + B e^{-Y}
\end{equation}

at \(Y = 0\) we have

\begin{equation}\label{eqn:continuumL20:850}
u = A + B = 0.
\end{equation}

so that
\begin{equation}\label{eqn:continuumL20:870}
B = -A.
\end{equation}

and we find for the inner region

\begin{equation}\label{eqn:continuumL20:890}
u = A (1 - e^{-Y}) = A( 1 - e^{-y/\epsilon} ) \sim 1 - e^{-y/\epsilon}.
\end{equation}

Taking these independent solutions for the inner and outer regions and putting them together into a coherent form (called matched asymptotic expansion) is a rich and tricky field.  For info on that we have been referred to \citep{hinch1991perturbation}.
} % end example
