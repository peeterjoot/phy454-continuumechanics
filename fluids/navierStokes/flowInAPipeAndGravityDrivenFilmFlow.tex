%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%

%
%

%\chapter{PHY454H1S\\Continuum Mechanics.  Lecture 12: Flow in a pipe.  Gravity driven flow of a film.  Taught by Prof. K. Das}
%\section{Flow in a pipe.  Gravity driven flow of a film}
\label{chap:continuumL12}

%\section{Review.  Steady rectilinear flow}
%
%Steady:
%
%\begin{equation}\label{eqn:continuumL12:10}
%\PD{t}{} = 0
%\end{equation}
%
%Rectilinear is a unidirectional flow such as
%
%\begin{equation}\label{eqn:continuumL12:30}
%\Bu = \xcap u( x, y, z ),
%\end{equation}
%
%\begin{enumerate}
%\item
%Utilizing an incompressibility assumption \(\spacegrad \cdot \Bu = 0\), so for this case we have
%
%\begin{equation*}
%\PD{x}{u} = 0
%\end{equation*}
%
%or
%
%\begin{equation*}
%u = u(y, z)
%\end{equation*}
%
%Note that Prof. Das called this a continuity requirement, and justified this label with the relation
%
%\begin{equation}\label{eqn:classicalMechanicsPs2:550}
%\frac{d\rho}{dt} = \rho (\spacegrad \cdot \Bu),
%\end{equation}
%
%which was a consequence of mass conservation.  It is still not clear to me why he would call this a continuity requirement.
%
%\item Nonlinear term is zero.  \((\Bu \cdot \spacegrad) \Bu = 0\)
%\item \(p = p(x)\).  Since \(\frac{d^2 p}{dx^2} = 0\) we also have \(\frac{dp}{dx} = -G\), a constant.
%
%\item \(\mu \left( \PDSq{y}{u} + \PDSq{z}{u} \right) = G\)
%
%\end{enumerate}
%
\section{Solutions by intuition}

Two examples that we have solved analytically are illustrated in \cref{fig:continuumL12:continuumL12fig1} and \cref{fig:continuumL12:continuumL12fig2}

\imageFigure{../../figures/phy454/lec12_Simple_shear_flowFig1}{Simple shear flow}{fig:continuumL12:continuumL12fig1}{0.2}
\imageFigure{../../figures/phy454/lec12_Channel_flowFig2}{Channel flow}{fig:continuumL12:continuumL12fig2}{0.2}

Sometimes we can utilize solutions already found to understand the behavior of more complex systems.  Combining the two we can look at flow over a plate as in \cref{fig:continuumL12:continuumL12fig3}

\imageFigure{../../figures/phy454/lec12_Flow_on_a_plateFig3}{Flow on a plate}{fig:continuumL12:continuumL12fig3}{0.2}

Example 2.  Fluid in a container.  If the surface tension is altered on one side, we induce a flow on the surface, leading to a circulation flow.  This can be done for example, by introducing a heat source or addition of surfactant.

This is illustrated in \cref{fig:continuumL12:continuumL12fig4}
\imageFigure{../../figures/phy454/lec12_Circulation_flow_induced_by_altering_surface_tensionFig4}{Circulation flow induced by altering surface tension}{fig:continuumL12:continuumL12fig4}{0.4}

This sort of flow is hard to analyze, only first done by Steve Davis in the 1980's.  The point here is that we can use some level of intuition to guide our attempts at solution.

\makeexample{Flow down a pipe}{ex:fluids:pipeflow}{

Reading: \S 2 from \citep{acheson1990elementary}.

Recall that the Navier-Stokes equation is

\boxedEquation{eqn:continuumL12:570}{
\rho \PD{t}{\Bu} + \rho (\Bu \cdot \spacegrad) \Bu = - \spacegrad p + \mu \spacegrad^2 \Bu + \rho \Bf.
}

We need to express this in cylindrical coordinates \((r, \theta, z)\) as in \cref{fig:continuumL12:continuumL12fig5}
\imageFigure{../../figures/phy454/lec12_Flow_through_a_pipeFig5}{Flow through a pipe}{fig:continuumL12:continuumL12fig5}{0.2}

Our gradient is

\begin{equation}\label{eqn:classicalMechanicsPs2:610}
\spacegrad =
\rcap \PD{r}{} +
\frac{\thetacap}{r} \PD{\theta}{} +
\zcap \PD{z}{},
\end{equation}

For our Laplacian we find

\begin{equation}\label{eqn:flowInAPipeAndGravityDrivenFilmFlow:710}
\begin{aligned}
\spacegrad^2 &=
\left(
\rcap \PD{r}{} +
\frac{\thetacap}{r} \PD{\theta}{} +
\zcap \PD{z}{}
\right)
 \cdot
\left(
\rcap \PD{r}{} +
\frac{\thetacap}{r} \PD{\theta}{} +
\zcap \PD{z}{}
\right) \\
&=
\partial_{rr}
+ \frac{\thetacap}{r} \cdot (\partial_\theta \rcap) \partial_r
+ \inv{r} \partial_\theta \left( \inv{r} \partial_\theta \right)
+ \partial_{zz} \\
&=
\partial_{rr} + \inv{r} \partial_r + \inv{r^2} \partial_{\theta\theta} + \partial_{zz},
\end{aligned}
\end{equation}

which we can write as

\begin{equation}\label{eqn:continuumL12:630}
\spacegrad^2 = \inv{r} \PD{r}{} \left( r \PD{r}{} \right) + \inv{r^2} \PDSq{\theta}{} + \PDSq{z}{}.
\end{equation}

Navier-Stokes takes the form

\boxedEquation{eqn:classicalMechanicsPs2:650}{
\begin{aligned}
\rho \PD{t}{\Bu} &+ \rho
\left(
u_r \PD{r}{} +
\frac{u_\theta}{r} \PD{\theta}{} +
u_z \PD{z}{} \right) \Bu
=  \\
&-
\left(
\rcap \PD{r}{} +
\frac{\thetacap}{r} \PD{\theta}{} +
\zcap \PD{z}{}
\right)
p + \mu \left(
\inv{r} \PD{r}{} \left( r \PD{r}{} \right) + \inv{r^2} \PDSq{\theta}{} + \PDSq{z}{} \right)
\Bu + \rho \Bf.
\end{aligned}
}

It is pointed out in \citep{acheson1990elementary}, that our non-linear term \((\Bu \cdot \spacegrad) \Bu\), with \(\Bu = \rcap u_r + \thetacap u_\theta + \zcap u_z\) has contributions both from the coordinates \((u_r, u_\theta, u_z)\) and the unit vectors \(\{\rcap, \thetacap, \zcap\}\) since both \(\rcap\) and \(\thetacap\) have \(\theta\) dependence.  So if we wish to express Navier-Stokes in coordinate form we must write


\begin{dmath}\label{eqn:classicalMechanicsPs2:650b}
(\Bu \cdot \spacegrad) \Bu
=
\rcap (\Bu \cdot \spacegrad) u_r
+\thetacap (\Bu \cdot \spacegrad) u_\theta
+\zcap (\Bu \cdot \spacegrad) u_z
+ \frac{u_\theta}{r} \thetacap u_r
- \frac{u_\theta}{r} \rcap u_\theta
=
\rcap \left((\Bu \cdot \spacegrad) u_r
- \frac{u_\theta^2}{r}
\right)
+\thetacap \left((\Bu \cdot \spacegrad) u_\theta
+ \frac{u_r u_\theta}{r}
\right)
+\zcap \left((\Bu \cdot \spacegrad) u_z\right)
\end{dmath}

For steady state and incompressible fluids in the absence of body forces we have

\begin{equation}\label{eqn:continuumL12:670}
\left(
\rcap \PD{r}{} +
\frac{\thetacap}{r} \PD{\theta}{} +
\zcap \PD{z}{}
\right)
p = \mu \left(
\inv{r} \PD{r}{} \left( r \PD{r}{} \right) + \inv{r^2} \PDSq{\theta}{} + \PDSq{z}{} \right)
\Bu,
\end{equation}

or, in coordinates

\begin{equation}\label{eqn:continuumL12:690}
\begin{aligned}
\PD{r}{p}
&= \mu \left(
\inv{r} \PD{r}{} \left( r \PD{r}{} \right) + \inv{r^2} \PDSq{\theta}{} + \PDSq{z}{} \right)
u_r \\
\frac{1}{r} \PD{\theta}{p}
&= \mu \left(
\inv{r} \PD{r}{} \left( r \PD{r}{} \right) + \inv{r^2} \PDSq{\theta}{} + \PDSq{z}{} \right)
u_\theta \\
\PD{z}{p}
&= \mu \left(
\inv{r} \PD{r}{} \left( r \PD{r}{} \right) + \inv{r^2} \PDSq{\theta}{} + \PDSq{z}{} \right)
u_z
\end{aligned}
\end{equation}

With an assumption that we have no radial or circulatory flows (\(u_r = u_\theta = 0\)), and with \(u_z = w\) assumed to only have a radial dependence, our velocity is

\begin{equation}\label{eqn:continuumL12:50}
\Bu = \zcap w(r),
\end{equation}

and an assumption of linear pressure dependence

\begin{equation}\label{eqn:continuumL12:60}
\frac{dp}{dz} = -G,
\end{equation}

then Navier-Stokes takes the final simple form

\begin{equation}\label{eqn:continuumL12:70}
\inv{r} \frac{d}{dr} \left( r \frac{dw}{dr} \right) = - \frac{G}{\mu}.
\end{equation}

Solving this we have

\begin{equation}\label{eqn:continuumL12:90}
r \frac{dw}{dr} = - \frac{G r^2}{2\mu} + A
\end{equation}

\begin{equation}\label{eqn:continuumL12:110}
w = -\frac{G r^2}{4 \mu} + A \ln(r) + B
\end{equation}

Requiring finite solutions for \(r = 0\) means that we must have \(A = 0\).  Also \(w(a) = 0\), we have \(B = G a^2/4 \mu\) so we must have

\begin{equation}\label{eqn:continuumL12:130}
w(r) = \frac{G}{4 \mu}( a^2 - r^2 )
\end{equation}
} % end example

\makeexample{Gravity driven flow of a liquid film}{ex:fluids:inclinedgravityflow}{
%(This is one of our Professor's favorite problems).

Reading: \S 2.3 from \citep{acheson1990elementary}.

Coordinates as in \cref{fig:continuumL12:continuumL12fig6}
\imageFigure{../../figures/phy454/lec12_Gravity_driven_flow_down_an_inclined_planeFig6}{Gravity driven flow down an inclined plane}{fig:continuumL12:continuumL12fig6}{0.2}

\begin{equation}\label{eqn:continuumL12:150}
\Bu = \xcap u(y)
\end{equation}

%\unnumberedSubsection{Boundary conditions}
Our boundary conditions are

\begin{enumerate}
\item \(u(y = 0) = 0\)
\item Tangential stress at the air-liquid interface \(y = h\) is equal.

\begin{equation}\label{eqn:continuumL12:170}
\Btau \cdot (\Bsigma_l \cdot \ncap) = \Btau \cdot (\Bsigma_a \cdot \ncap),
\end{equation}
\end{enumerate}

We write

\begin{equation}\label{eqn:continuumL12:190}
\begin{aligned}
\Btau &=
\begin{bmatrix}
1 \\
0 \\
0
\end{bmatrix} \\
\ncap &=
\begin{bmatrix}
0 \\
1 \\
0
\end{bmatrix}
\end{aligned}
\end{equation}

and seek simultaneous solutions to the pair of stress tensor equations

\begin{equation}\label{eqn:continuumL12:210}
\begin{aligned}
\sigma_{ij}^l
&= - p \delta_{ij} + \mu^l \left(
\PD{x_j}{u_i} +
\PD{x_i}{u_j}
\right) \\
\sigma_{ij}^a
&= - p \delta_{ij} + \mu^a \left(
\PD{x_j}{u_i} +
\PD{x_i}{u_j}
\right).
\end{aligned}
\end{equation}

In general this requires an iterated approach, solving for one with an initial approximation of the other, then switching and tuning the numerical method carefully for convergence.

We expect that the flow of liquid will induce a flow of air at the interface, but may be able to make a one-sided approximation.  Let us see how far we get before we have to introduce any approximations and compute the traction vector for the liquid

\begin{equation}\label{eqn:flowInAPipeAndGravityDrivenFilmFlow:730}
\begin{aligned}
\Bsigma^l \cdot \ncap &=
\begin{bmatrix}
-p & \mu^l \PDi{y}{u} & 0 \\
\mu^l \PDi{y}{u} & -p & 0 \\
0 & 0 & 0
\end{bmatrix}
\begin{bmatrix}
0 \\
1 \\
0
\end{bmatrix} \\
&=
\begin{bmatrix}
\mu^l \PDi{y}{u} \\
-p \\
0
\end{bmatrix}
\end{aligned}
\end{equation}

So

\begin{equation}\label{eqn:continuumL12:230}
\Btau \cdot (\Bsigma^l \cdot \ncap)
=
\begin{bmatrix}
1 & 0 & 0
\end{bmatrix}
\begin{bmatrix}
\mu^l \PDi{y}{u} \\
-p \\
0
\end{bmatrix}
=
\mu^l \PD{y}{u}
\end{equation}

Our boundary value condition is therefore

\begin{equation}\label{eqn:continuumL12:250}
\evalbar{\mu^l \PD{y}{u^l}}{y = h} =
\evalbar{\mu^a \PD{y}{u^a}}{y = h}
\end{equation}

When can we decouple this, treating only the liquid?  Observe that we have

\begin{equation}\label{eqn:continuumL12:270}
\evalbar{\PD{y}{u^l}}{y = h} =
\evalbar{\frac{\mu^a}{\mu^l} \PD{y}{u^a}}{y = h}
\end{equation}

so if

\begin{equation}\label{eqn:continuumL12:290}
\frac{\mu_a}{\mu_l} \ll 1
\end{equation}

we can treat only the liquid portion of the problem, with a boundary value condition

\begin{equation}\label{eqn:continuumL12:310}
\evalbar{\PD{y}{u^l}}{y = h} = 0.
\end{equation}

Let us look at the component of the traction vector in the direction of the normal (liquid pressure acting on the air)

\begin{equation}\label{eqn:continuumL12:330}
\ncap \cdot (\Bsigma^l \cdot \ncap) = \ncap \cdot (\Bsigma^a \cdot \ncap)
\end{equation}

or

\begin{equation}\label{eqn:continuumL12:350}
\begin{bmatrix}
0 & 1 & 0
\end{bmatrix}
\begin{bmatrix}
\mu^l \PD{y}{u} \\
-p^l \\
0
\end{bmatrix}
= -\evalbar{p^l}{y = h} = -\evalbar{p^a}{y = h}
\end{equation}

i.e. We have pressure matching at the interface.

Our body force is

\begin{equation}\label{eqn:continuumL12:370}
\Bf =
\begin{bmatrix}
g \sin\alpha \\
-g \cos\alpha \\
0
\end{bmatrix}
\end{equation}

%\unnumberedSubsection{Navier-stokes}
Referring to the Navier-Stokes equation \eqnref{eqn:continuumL12:570}, we see that our only surviving parts are

\begin{subequations}
\begin{equation}\label{eqn:classicalMechanicsPs2:590a}
0 = -\PD{x}{p} + \mu \PDSq{y}{u} + \rho g \sin\alpha
\end{equation}
\begin{equation}\label{eqn:classicalMechanicsPs2:590b}
0 = -\PD{y}{p} - \rho g \cos\alpha
\end{equation}
\begin{equation}\label{eqn:classicalMechanicsPs2:590c}
0 = -\PD{z}{p}
\end{equation}
\end{subequations}

The last gives us \(p \ne p(z)\).  Integrating the second we have

\begin{equation}\label{eqn:continuumL12:410}
p = \rho g y \cos\alpha + p_1
\end{equation}

Since \(p = p_{\text{atm}}\) at \(y = h\), we have

\begin{equation}\label{eqn:continuumL12:430}
p_{\text{atm}} = \rho g h \cos\alpha + p_1
\end{equation}

Our first Navier-Stokes equation \eqnref{eqn:classicalMechanicsPs2:590a} becomes

\begin{equation}\label{eqn:continuumL12:450}
0 = \mu \PDSq{y}{u} + \rho g \sin\alpha,
\end{equation}

or
\begin{equation}\label{eqn:continuumL12:470}
\PDSq{y}{u} = -\frac{\rho g}{\mu} \sin\alpha
\end{equation}

This we integrate twice

\begin{equation}\label{eqn:continuumL12:490}
u = - \rho g \frac{\sin\alpha}{2 \mu} y^2 + A y + B
\end{equation}

With

\begin{equation}\label{eqn:continuumL12:510a}
u(0) = 0,
\end{equation}

we see that \(B = 0\), and with

\begin{equation}\label{eqn:continuumL12:510b}
\evalbar{\PD{y}{u}}{y = h} = 0,
\end{equation}

we find that

\begin{equation}\label{eqn:continuumL12:510c}
0 = - \rho g \frac{\sin\alpha}{\mu} h + A,
\end{equation}

for

\begin{equation}\label{eqn:classicalMechanicsPs2:530}
u = \rho g y \frac{\sin\alpha}{2 \mu} y \left( 2 h - y \right).
\end{equation}

This velocity distribution is illustrated \cref{fig:continuumL12:continuumL12fig7}.

\imageFigure{../../figures/phy454/lec12_Velocity_streamlines_for_flow_down_a_planeFig7}{Velocity streamlines for flow down a plane}{fig:continuumL12:continuumL12fig7}{0.2}

It is important to note that in these problems we have to derive our boundary value conditions!  They are not given.

In this discussion, the height \(h\) was assumed to be constant, with the tangential direction constant and parallel to the surface that the liquid is flowing on.  It is claimed in class that this is actually a consequence of surface tension only!
\FIXME{That is not at all intuitive, but will be covered when we learn about ``stability conditions''.  This was not actually covered in class.}
} % end example
