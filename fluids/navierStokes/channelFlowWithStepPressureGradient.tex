%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%

%
%
\makeoproblem{Channel flow with step pressure gradient}
{problem:fluids:channelFlowWithStepPressureGradient}
{\citep{acheson1990elementary} problem 2.5}
{
Viscous fluid is at rest in a two-dimensional channel between stationary rigid walls with \(y = \pm h\).  For \(t \ge 0\) a constant pressure gradient \(P = -dp/dx\) is imposed.  Show that \(u(y, t)\) satisfies

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:10}
\PD{t}{u} = \nu \PDSq{y}{u} + \frac{P}{\rho},
\end{equation}

and give suitable initial and boundary conditions.  Find \(u(y, t)\) in form of a Fourier series, and show that the flow approximates to steady channel flow when \(t \gg h^2/\nu\).

} % makeoproblem

\makeanswer{problem:fluids:channelFlowWithStepPressureGradient}{
With only horizontal components to the flow, the Navier-Stokes equations for incompressible flow are

\begin{subequations}
\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:30}
\PD{t}{u} + u \PD{x}{u} = -\inv{\rho} \PD{x}{p} + \nu \left(
\PDSq{x}{}
+\PDSq{y}{}
\right)
u
\end{equation}
\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:50}
\PD{x}{u} = 0
\end{equation}
\end{subequations}

Substitution of \eqnref{eqn:channelFlowWithStepPressureGradient:50} into \eqnref{eqn:channelFlowWithStepPressureGradient:30} gives us

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:70}
\PD{t}{u} = -\inv{\rho} \PD{x}{p} + \nu \PDSq{y}{u}.
\end{equation}

Our equation to solve is therefore

\boxedEquation{eqn:channelFlowWithStepPressureGradient:90}{
\PD{t}{u} = \Theta(t) \frac{P}{\rho} + \nu \PDSq{y}{u}.
}

This equation, for \(t < 0\), allows for solutions

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:110}
u = A y + B
\end{equation}

but the problem states that the fluid is at rest initially, so we do not really have to solve anything (i.e. \(A = B = 0\)).

The no-slip conditions introduce boundary value conditions \(u(\pm h, t) = 0\).

For \(t \ge 0\) we have

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:130}
\PD{t}{u} = \frac{P}{\rho} + \nu \PDSq{y}{u}.
\end{equation}

If we attempt separation of variables with \(u(y, t) = Y(y) T(t)\), our equation takes the form

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:150}
T' Y = \frac{P}{\rho} + \nu T Y''.
\end{equation}

We see that the non-homogeneous term prevents successful application of separation of variables.  Let us modify our problem by attempting to recast our equation into a homogeneous form by adding a particular solution for the steady state flow problem.  That problem was the solution of

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:170}
\PDSq{y}{} u_s(y, 0) = -\frac{P}{\rho \nu}
\end{equation}

which has solution

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:190}
u_s(y, 0) = \frac{P}{2 \rho \nu} \left( h^2 - y^2 \right) + A y + B.
\end{equation}

The freedom to incorporate an \(h^2\) constant into the equation as an integration constant has been employed, knowing that it will kill the \(y^2\) contributions at \(y = \pm h\) to make the boundary condition matching easier.  Our no-slip conditions give us

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:210}
\begin{aligned}
0 &= A h + B \\
0 &= -A h + B.
\end{aligned}
\end{equation}

Adding this we have \(2 B = 0\), and subtracting gives us \(2 A h = 0\), so a specific solution that matches our required boundary value (and initial value) conditions is just the steady state channel flow solution we are familiar with

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:230}
u_s(y, 0) = \frac{P}{2 \rho \nu} \left( h^2 - y^2 \right).
\end{equation}

Let us now assume that our general solution has the form

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:250}
u(y, t) = u_H(y, t) + u_s(y, 0).
\end{equation}

Applying the Navier-Stokes equation to this gives us

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:270}
\PD{t}{u_H} = \frac{P}{\rho} + \nu \PDSq{y}{u_H} + \nu \PDSq{y}{u_s}.
\end{equation}

But from \eqnref{eqn:channelFlowWithStepPressureGradient:170}, we see that all we have left is a homogeneous problem in \(u_H\)

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:270b}
\PD{t}{u_H} = \nu \PDSq{y}{u_H},
\end{equation}

where our boundary value conditions are now given by

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:590}
\begin{aligned}
0
&= u_H(\pm h, t) + u_s(\pm h) \\
&= u_H(\pm h, t),
\end{aligned}
\end{equation}

and

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:610}
\begin{aligned}
0
&= u(y, 0) \\
&= u_H(y, 0) + \frac{P}{2 \rho \nu} \left( h^2 - y^2 \right),
\end{aligned}
\end{equation}

or
\begin{subequations}
\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:290}
u_H(\pm h, t) = 0
\end{equation}
\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:310}
u_H(y, 0) = -\frac{P}{2 \rho \nu} \left( h^2 - y^2 \right).
\end{equation}
\end{subequations}

Now we can apply separation of variables with \(u_H = T(t) Y(y)\), yielding

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:150b}
T' Y = \nu T Y'',
\end{equation}

or

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:330}
\frac{T'}{T} = \nu \frac{Y''}{Y} = \text{constant} = - \nu \alpha^2.
\end{equation}

Here a positive constant \(\nu \alpha^2\) has been used assuming that we want a solution that is damped with time.

Our solutions are

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:350}
\begin{aligned}
T &\propto e^{- \nu \alpha^2 t} \\
Y &= A \sin \alpha y + B \cos\alpha y,
\end{aligned}
\end{equation}

or

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:370}
u_H(y, t) = \sum_\alpha e^{-\alpha^2 \nu t} \left( A_\alpha \sin \alpha y + B_\alpha \cos\alpha y \right).
\end{equation}

We have constraints on \(\alpha\) due to our boundary value conditions.  For our sin terms to be solutions we require

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:390}
\sin (\alpha (\pm h)) = \sin n \pi
\end{equation}

and for our cosine terms to be solutions we require

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:410}
\cos (\alpha (\pm h)) = \cos \left( \frac{\pi}{2} + n \pi \right)
\end{equation}

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:430}
\begin{aligned}
\alpha &= \frac{2 n \pi}{2 h} \\
\alpha &= \frac{2 n + 1 \pi}{2 h}
\end{aligned}
\end{equation}

respectively.

Our homogeneous solution therefore takes the form

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:450}
u_H(y, t) =
C_0 + \sum_{m > 0} C_m e^{ -(m \pi/2h)^2 \nu t }
\left\{
\begin{array}{l l}
\sin \left( \frac{ m \pi y }{2 h} \right) & \quad \mbox{\(m\) even} \\
\cos \left( \frac{ m \pi y }{2 h} \right) & \quad \mbox{\(m\) odd} \\
\end{array}
\right.
\end{equation}

Our undetermined constants should be provided by the boundary value constraint at \(t = 0\) \eqnref{eqn:channelFlowWithStepPressureGradient:310}, leaving us to solve the Fourier problem

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:470}
-\frac{P}{2 \mu} \left( h^2 - y^2 \right)
=
%C_0 +
\sum_{m \ge 0} C_m
\left\{
\begin{array}{l l}
\sin \left( \frac{ m \pi y }{2 h} \right) & \quad \mbox{\(m\) even} \\
\cos \left( \frac{ m \pi y }{2 h} \right) & \quad \mbox{\(m\) odd} \\
\end{array}
\right.
\end{equation}

%We find \(C_0\) by integrating over \([-h, h]\)
%
%\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:490}
%\int_{-h}^h -\frac{P}{2 \mu} \left( h^2 - y^2 \right) dy = 2 h C_0,
%\end{equation}
%
%which yields
%
%\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:510}
%C_0 = -\frac{P h^2}{12 \mu}.
%\end{equation}

Multiplying by a sine and integrating will clearly give zero (even times odd function over a symmetric interval).  Let us see if there is any scaling required to select out the \(C_m\) term

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:630}
\begin{aligned}
\int_{-h}^h
\cos \left( \frac{ m \pi y }{2 h} \right)
\cos \left( \frac{ n \pi y }{2 h} \right) dy
&=
\frac{2h}{\pi} \int_{-h}^h
\cos \left( \frac{ m \pi y }{2 h} \right)
\cos \left( \frac{ n \pi y }{2 h} \right) \pi dy/2h \\
&=
\frac{2h}{\pi} \int_{-\pi/2}^{\pi/2}
\cos m x \cos n x dx \\
&=
\frac{h}{\pi} \int_{-\pi/2}^{\pi/2}
\left(
\cos( (m - n) \pi/2 )
+\cos( (m + n) \pi/2 )
\right) dx
\end{aligned}
\end{equation}

Note that since \(m\) and \(n\) must be odd, \(m \pm n = 2 c\) for some integer \(c\), so this integral is zero unless \(m = n\) (consider \(m = 2 a + 1, n = 2 b + 1\)).  For the \(m = n\) term we have

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:650}
\begin{aligned}
\int_{-h}^h
\cos \left( \frac{ m \pi y }{2 h} \right)
\cos \left( \frac{ n \pi y }{2 h} \right) dy
&=
\frac{h}{\pi} \int_{-\pi/2}^{\pi/2}
\left(
1
+\cos( m \pi )
\right) dx \\
&=
h
\end{aligned}
\end{equation}

Therefore, our constants \(C_m\) (for odd \(m\)) are given by

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:670}
\begin{aligned}
C_m
&=
-\frac{P h }{2 \mu}
\int_{-h}^h
\left( 1 - \left( \frac{y}{h}\right)^2 \right)
\cos \left( \frac{ m \pi y }{2 h} \right) dy \\
&=
-\frac{P h^2 }{2 \mu}
\int_{-1}^1
\left( 1 - x^2 \right)
\cos \left( \frac{ m \pi x }{2} \right) x  \\
\end{aligned}
\end{equation}

With \(m = 2 n + 1\), we have

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:530}
C_{2 n + 1} = -\frac{16 P h^2 (-1)^n}{\mu \pi^3 (2 n + 1)^3}.
\end{equation}

For that calculation see (\nbref{channelFlowWithStepPressureGradient.cdf}).

Our complete solution is

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:550}
u(y, t) =
\frac{P h^2}{2 \mu} \left( 1 - \left( \frac{y}{h} \right)^2 \right)
%-\frac{P h^2}{12 \mu}
-
\frac{16 P h^2 }{\mu \pi^3 }
\sum_{n = 0}^\infty
\frac{(-1)^n}{(2 n + 1)^3}
e^{ -((2 n + 1) \pi/2h)^2 \nu t }
\cos \left( \frac{ (2 n + 1) \pi y }{2 h} \right) .
\end{equation}
%Sum[(-1)^n/((2 n + 1)^3) E^( -((2 n + 1) Pi/(2 h))^2 nu t ) Cos[ (2 n + 1) Pi y /(2 h) ], {n, 0, m}]

The largest of the damped exponentials above is the \(n = 0\) term which is

\begin{equation}\label{eqn:channelFlowWithStepPressureGradient:570}
e^{ - \pi^2 \nu t /h^2 },
\end{equation}

so if \(\nu t >> h^2\) these terms all die off, leaving us with just the steady state.
%.  That leaves us with the steady state equation, less the non-damped constant factor from the Fourier series.

Rather remarkably, this Fourier series is actually a very good fit even after only a single term.  Using the viscosity and density of water, \(h = 1 \text{cm}\), and \(P = 3 \times \mu_{\text{water}} \times (2 \text{cm}/{s})/ h^2\) (parameterizing the pressure gradient by the average velocity it will induce), a plot of the parabola that we are fitting to and the difference of that from the first Fourier term is shown in \cref{fig:channelFlowWithStepPressureGradient:channelFlowWithStepPressureGradientFig1}.

\imageFigure{../../figures/phy454/channelFlowWithStepPressureGradientFig1}{Parabolic channel flow steady state, and difference from first Fourier term}{fig:channelFlowWithStepPressureGradient:channelFlowWithStepPressureGradientFig1}{0.3}

The higher order corrections are even smaller.  Even the first order deviations from the parabola that we are fitting to is a correction on the scale of \(1/100\) of the height of the parabola.  This is illustrated in \cref{fig:channelFlowWithStepPressureGradient:channelFlowWithStepPressureGradientFig2} where the magnitude of the first 5 deviations from the steady state are plotted.

\imageFigure{../../figures/phy454/channelFlowWithStepPressureGradientFig2}{Difference from the steady state for the first five Fourier terms}{fig:channelFlowWithStepPressureGradient:channelFlowWithStepPressureGradientFig2}{0.3}

An animation of the time evolution above can be found at \youtubehref{0vZuv9HBtmo}.
%in \cref{fig:channelFlowWithStepPressureGradient:channelFlowWithStepPressureGradientFig3}.  If this animation is unavailable, it can also be found at

%\movieFigure{./channelFlowWithStepPressureGradientTimeEvolution.mp4}{Time evolution of channel flow velocity profile after turning on a constant pressure gradient}{fig:channelFlowWithStepPressureGradient:channelFlowWithStepPressureGradientFig3}{width=320pt,height=240pt}

It is also interesting to look at the very earliest part of the time evolution (\youtubehref{dDkx8iLwOew}), where some oscillatory phenomena can be seen.
%Observe in \cref{fig:channelFlowWithStepPressureGradient:channelFlowWithStepPressureGradientFig4} (or
Could some of that be due to not running with enough Fourier terms in this early part of the evolution when more terms are probably significant?

%\movieFigure{./channelFlowWithStepPressureGradientEarlyTimeEvolution.mp4}{Early time evolution of channel flow velocity profile after turning on a constant pressure gradient}{fig:channelFlowWithStepPressureGradient:channelFlowWithStepPressureGradientFig4}{width=320pt,height=240pt}
} % end answer
