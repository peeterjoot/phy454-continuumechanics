%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%

%
%
\makeoproblem{Couette flow of a viscous incompressible fluid}{problem:fluids:couetteFlow}
{2011 phy1530 problem set 2}
{
Consider the steady flow between two long cylinders of radii \(R_1\) and \(R_2\), \(R_1 > R_1\), rotating about their axes with angular velocities \(\Omega_1\), \(\Omega_2\).  Look for a solution of the form, where \(\phicap\) is a unit vector along the azimuthal direction:

\begin{subequations}
\begin{equation}\label{eqn:couetteFlow:10}
\Bu = v(r) \phicap
\end{equation}
\begin{equation}\label{eqn:couetteFlow:30}
p = p(r).
\end{equation}
\end{subequations}

\makesubproblem{Write out the Navier-Stokes equations and find differential equations for \(v(r)\) and \(p(r)\).  You should find that these equations have relatively simple solutions, i.e.,

\begin{equation}\label{eqn:couetteFlow:50}
v(r) = a r + \frac{b}{r}.
\end{equation}
}{problem:fluids:couetteFlow:1}

\makesubproblem{Fix the constants \(a\) and \(b\) from the boundary conditions.  Determine the pressure \(p(r)\)}{problem:fluids:couetteFlow:2}
\makesubproblem{Compute the friction forces that the fluid exerts on the cylinders, and compute the torque on each cylinder.  Show that the total torque on the fluid is zero (as must be the case)}{problem:fluids:couetteFlow:3}
} % makeoproblem

\makeanswer{problem:fluids:couetteFlow}{
This is also a problem that I recall was outlined in \S 2 from \citep{acheson1990elementary}.  Some of the instabilities that are mentioned in the text are nicely illustrated in \citep{wiki:taylorCouette}.

We illustrate our system in \cref{fig:couetteFlow:couetteFlowFig1}.

\imageFigure{../../figures/phy454/couetteFlowFig1}{Couette flow configuration}{fig:couetteFlow:couetteFlowFig1}{0.3}

\makesubanswer{Navier-Stokes}{problem:fluids:couetteFlow:1}
Navier-Stokes for steady state incompressible flow has the form

\begin{subequations}
\begin{equation}\label{eqn:couetteFlow:70}
(\Bu \cdot \spacegrad) \Bu = -\inv{\rho} \spacegrad p + \nu \spacegrad^2 \Bu
\end{equation}
\begin{equation}\label{eqn:couetteFlow:90}
\spacegrad \cdot \Bu = 0.
\end{equation}
\end{subequations}

where the gradient has the form

\begin{equation}\label{eqn:couetteFlow:110}
\spacegrad = \rcap \partial_r + \frac{\phicap}{r} \partial_\phi.
\end{equation}

Let us first verify that the incompressible condition \eqnref{eqn:couetteFlow:90} is satisfied for the presumed form of the solution we seek.  We have

\begin{equation}\label{eqn:couetteFlow:1330}
\begin{aligned}
\spacegrad \cdot \Bu
&=
\left( \rcap \partial_r + \frac{\phicap}{r} \partial_\phi \right) \cdot (v(r) \phicap(\phi) ) \\
&=
(\rcap \cdot \phicap) v' + \frac{\phicap^2}{r} \partial_\phi v(r)
+ \frac{v(r) \phicap}{r} \cdot \partial_\phi \phicap \\
&=
 \frac{v(r) \phicap}{r} \cdot (-\rcap) \\
&= 0
\end{aligned}
\end{equation}

Good.  Now let us write out the terms of the momentum conservation equation \eqnref{eqn:couetteFlow:70}.  We have got

\begin{equation}\label{eqn:couetteFlow:1350}
\begin{aligned}
(\Bu \cdot \spacegrad) \Bu
&=
\frac{ v}{r} \partial_\phi  ( v \phicap ) \\
&=
-\frac{ v^2 \rcap}{r},
\end{aligned}
\end{equation}

and
\begin{equation}\label{eqn:couetteFlow:1370}
\begin{aligned}
-\inv{\rho} \spacegrad p
&=
-\inv{\rho} \left( \rcap \partial_r + \frac{\phicap}{r} \partial_\phi \right) p(r) \\
&=
-\frac{\rcap p'}{\rho},
\end{aligned}
\end{equation}

and

\begin{equation}\label{eqn:couetteFlow:1390}
\begin{aligned}
\nu \spacegrad^2 \Bu
&=
\nu
\left( \rcap \partial_r + \frac{\phicap}{r} \partial_\phi \right) \cdot
\left( \rcap \partial_r + \frac{\phicap}{r} \partial_\phi \right)
(v(r) \phicap(\phi)) \\
&=
\nu
\left(
\partial_{rr} + \inv{r^2} \partial_{\phi\phi}
+
\frac{\phicap}{r} \partial_\phi \cdot (\rcap \partial_r)
\right)
(v(r) \phicap(\phi)) \\
&=
\nu
\left(
\partial_{rr} + \inv{r^2} \partial_{\phi\phi}
+
\frac{1}{r} \partial_r
\right)
(v(r) \phicap(\phi)) \\
&=
\nu
\left(
\inv{r} \partial_{r} (r \partial_r) + \inv{r^2} \partial_{\phi\phi}
\right)
(v(r) \phicap(\phi)) \\
&=
\nu
\left(
\inv{r} (r v')' - \frac{v}{r^2}
\right)
\phicap
\end{aligned}
\end{equation}

So the momentum equation of Navier-Stokes takes the form

\boxedEquation{eqn:couetteFlow:1310}{
-\frac{ v^2 \rcap}{r} =
-\frac{\rcap p'}{\rho}
+
\nu
\left(
\inv{r} (r v')' - \frac{v}{r^2}
\right)
\phicap.
}

Equating \(\rcap\) and \(\phicap\) components we have two equations to solve

\begin{subequations}
\begin{equation}\label{eqn:couetteFlow:130}
r (r v')' - v = 0
\end{equation}
\begin{equation}\label{eqn:couetteFlow:150}
p' = \frac{\rho v^2}{r}.
\end{equation}
\end{subequations}

Expanding out our velocity equation we have

\begin{equation}\label{eqn:couetteFlow:170}
r^2 v'' + r v' - v = 0,
\end{equation}

for which we have been told to expect that \eqnref{eqn:couetteFlow:50} is a solution (and it has the two integration constants we require for a solution to a homogeneous equation of this form).  Let us verify that we have computed the correct differential equation for the problem by trying this solution

\begin{equation}\label{eqn:couetteFlow:1410}
\begin{aligned}
r^2 v'' + r v' - v
&=
r^2 \left( a -\frac{b}{r^2} \right)' + r \left( a -\frac{b}{r^2} \right) - a r - \frac{b}{r} \\
&=
r^2 \frac{2 b}{r^3} + \cancel{a r} - \frac{b}{r} - \cancel{a r} - \frac{b}{r} \\
&=
\frac{2 b}{r} - \frac{2 b}{r} \\
&= 0.
\end{aligned}
\end{equation}

Given the velocity, we can now determine the pressure up to a constant

\begin{equation}\label{eqn:couetteFlow:1430}
\begin{aligned}
p'
&= \frac{\rho}{r} \left( a r + \frac{b}{r} \right)^2 \\
&= \frac{\rho}{r} \left( a^2 r^2 + \frac{b^2}{r^2} + 2 a b \right) \\
&= \rho \left( a^2 r + \frac{b^2}{r^3} + 2 \frac{a b}{r} \right)
\end{aligned}
\end{equation}

so
\begin{equation}\label{eqn:couetteFlow:190}
p_r -p_0
= \rho \left( \inv{2} a^2 r^2 - \frac{b^2}{2 r^2} + 2 a b \ln r \right)
\end{equation}

\makesubanswer{Constants and the pressure}{problem:fluids:couetteFlow:2}
To determine our integration constants we recall that velocity associated with a radial position \(\Bx = r \rcap\) in cylindrical coordinates takes the form

\begin{equation}\label{eqn:couetteFlow:210}
\frac{\Bx}{dt} = \rdot \rcap + r \phicap \phidot,
\end{equation}

where \(\phidot\) is the angular velocity.  The cylinder walls therefore have the velocity

\begin{equation}\label{eqn:couetteFlow:230}
v = r \phidot,
\end{equation}

so our boundary conditions (given a no-slip assumption for the fluids) are

\begin{equation}\label{eqn:couetteFlow:250}
\begin{aligned}
v(R_1) &= R_1 \Omega_1 \\
v(R_2) &= R_2 \Omega_2.
\end{aligned}
\end{equation}

This gives us a pair of equations to solve for \(a\) and \(b\)

\begin{equation}\label{eqn:couetteFlow:270}
\begin{aligned}
R_1 \Omega_1 &= a R_1 + \frac{b}{R_1} \\
R_2 \Omega_2 &= a R_2 + \frac{b}{R_2}.
\end{aligned}
\end{equation}

Multiplying each by \(R_1\) and \(R_2\) respectively gives us

\begin{equation}\label{eqn:couetteFlow:290}
b = R_1^2 (\Omega_1 - a) = R_2^2 (\Omega_2 - a).
\end{equation}

Rearranging for \(a\) we find

\begin{equation}\label{eqn:couetteFlow:310}
R_1^2 \Omega_1 - R_2^2 \Omega_2 = (R_1^2 - R_2^2) a,
\end{equation}

or

\begin{equation}\label{eqn:couetteFlow:330}
a = \frac{ R_2^2 \Omega_2 - R_1^2 \Omega_1}{R_2^2 - R_1^2}.
\end{equation}

For \(b\) we have

\begin{equation}\label{eqn:couetteFlow:1450}
\begin{aligned}
b &=
R_1^2 (\Omega_1 - a) \\
&=
\frac{R_1^2 }{R_2^2 - R_1^2}
(\Omega_1 ( R_2^2 - \cancel{R_1^2}) -
R_2^2 \Omega_2 + \cancel{R_1^2 \Omega_1}
),
\end{aligned}
\end{equation}

or

\begin{equation}\label{eqn:couetteFlow:350}
b = \frac{R_1^2 R_2^2}{R_2^2 - R_1^2} (\Omega_1 -\Omega_2).
\end{equation}

This gives us


\begin{subequations}
\begin{equation}\label{eqn:couetteFlow:370}
v(r) =
\inv{R_2^2 - R_1^2}
\left(
\left( R_2^2 \Omega_2 - R_1^2 \Omega_1\right) r
+\frac{R_1^2 R_2^2}{r} (\Omega_1 -\Omega_2)
\right)
\end{equation}
\begin{dmath}\label{eqn:couetteFlow:390}
p(r) -p_0
= \frac{\rho }{(R_2^2 - R_1^2)^2} \times
\left( \inv{2}
\left( R_2^2 \Omega_2 - R_1^2 \Omega_1\right)^2
r^2
-\frac{R_1^4 R_2^4}{2 r^2} (\Omega_1  - \Omega_2)^2
+ 2 \left( R_2^2 \Omega_2 - R_1^2 \Omega_1\right) R_1^2 R_2^2 (\Omega_1 - \Omega_2) \ln r
\right).
\end{dmath}
\end{subequations}

\FIXME{This is almost a complete solution.  The part that I am unsure about is how to fix the \(p_0\) integration constant.  In the solution of this problem posted from the course this was just set to 0, but I do not see a good reason for that.  I will try asking this on \href{http://www.physicsforums.com/showthread.php?t=595132}{physicsforums} and see if I can get some help there}

\makesubanswer{Friction torque on the cylinders}{problem:fluids:couetteFlow:3}
We can expand out the identity for the traction vector

\begin{dmath}\label{eqn:couetteFlow:970}
\Bt_{\ncap}
= \Be_i \sigma_{ij} n_j
= -p \ncap + \mu \left(
2 (\ncap \cdot \spacegrad) \Bu + \ncap \cross (\spacegrad \cross \Bu)
\right),
\end{dmath}

in cylindrical coordinates and find

\begin{subequations}
\begin{equation}\label{eqn:couetteFlow:990}
\Bt_{\rcap} \cdot \rcap
=
\sigma_{rr}
=
-p + 2 \mu \cancel{\PD{r}{u_r}}
\end{equation}
\begin{equation}\label{eqn:couetteFlow:1010}
\Bt_{\phicap} \cdot \phicap
=
\sigma_{\phi \phi}
=
-p + 2 \mu
\left(
\inv{r}
\cancel{\PD{\phi}{u_\phi}} + \cancel{\frac{u_r}{r}}
\right)
\end{equation}
\begin{equation}\label{eqn:couetteFlow:1030}
\Bt_{z} \cdot \zcap
=
\sigma_{z z}
=
-p + 2 \mu
\cancel{\PD{z}{u_z}}
\end{equation}
\begin{equation}\label{eqn:couetteFlow:1050}
\Bt_{\rcap} \cdot \phicap
=
\sigma_{r \phi}
=
\mu \left(
 \PD{r}{u_\phi}
+\inv{r} \cancel{\PD{\phi}{u_r}}
- \frac{u_\phi}{r}
\right)
\end{equation}
\begin{equation}\label{eqn:couetteFlow:1070}
\Bt_{\phicap} \cdot \zcap
=
\sigma_{\phi z}
=
\mu \left(
\frac{1}{r} \cancel{\PD{\phi}{u_z}}
    + \cancel{\PD{z}{u_\phi}}
\right)
\end{equation}
\begin{equation}\label{eqn:couetteFlow:950}
\Bt_{\zcap} \cdot \rcap
=
\sigma_{z r}
=
\mu \left(
\cancel{\PD{z}{u_r}}
+ \cancel{\PD{r}{u_z}}
\right),
\end{equation}
\end{subequations}

so we have

\begin{subequations}
\begin{equation}\label{eqn:couetteFlow:1090}
\sigma_{rr} = \sigma_{\phi \phi} = \sigma_{z z} = -p
\end{equation}
\begin{equation}\label{eqn:couetteFlow:1110}
\sigma_{\phi z} = \sigma_{z r} = 0
\end{equation}
\begin{equation}\label{eqn:couetteFlow:1130}
\sigma_{r \phi} = \mu \left( \PD{r}{u_\phi} - \frac{u_\phi}{r} \right)
\end{equation}
\end{subequations}

We want to expand the last of these

\begin{equation}\label{eqn:couetteFlow:1470}
\begin{aligned}
\sigma_{r \phi}
&= \mu \left( \PD{r}{u_\phi} - \frac{u_\phi}{r} \right) \\
&= \mu \left(
a r + \frac{b}{r}
\right)' \\
&= \mu \left(
a - \frac{b}{r^2}
\right).
\end{aligned}
\end{equation}

So the traction vector \(\Bt_1 = \Bsigma \cdot \rcap = \Be_i \sigma_{ij} \rcap \cdot \Be_i\), our force per unit area on the fluid at the inner surface (where the normal is \(\rcap\)), is

\begin{equation}\label{eqn:couetteFlow:1150}
\Bt_1 =
-p \rcap + \mu \left( a - \frac{b}{r^2} \right) \phicap
=
-p \rcap +
\frac{\mu}{R_2^2 - R_1^2}
\left(
R_2^2 \Omega_2 - R_1^2 \Omega_1
+\frac{R_1^2 R_2^2}{r^2} (\Omega_2 -\Omega_1)
\right) \phicap.
\end{equation}

and our torque per unit area from the inner cylinder on the fluid is thus

\begin{equation}\label{eqn:couetteFlow:1170}
\Btau_1 = r \rcap \cross \Bt_1 =
%r \mu \left( a - \frac{b}{r^2} \right) \zcap.
\frac{r \mu}{R_2^2 - R_1^2}
\left(
R_2^2 \Omega_2 - R_1^2 \Omega_1
+\frac{R_1^2 R_2^2}{r^2} (\Omega_2 -\Omega_1)
\right) \zcap.
\end{equation}

Observing that our stress tensors flip sign for an inwards normal, our torque per unit area from the outer cylinder on the fluid is

\begin{equation}\label{eqn:couetteFlow:1190}
\Btau_2 = r \rcap \cross (-\Bt_1) =
%-r \mu \left( a - \frac{b}{r^2} \right) \zcap.
-\frac{r \mu}{R_2^2 - R_1^2}
\left(
R_2^2 \Omega_2 - R_1^2 \Omega_1
+\frac{R_1^2 R_2^2}{r^2} (\Omega_2 -\Omega_1)
\right) \zcap.
\end{equation}

For the complete torque on the fluid due to a strip of width \(\Delta z\) the magnitudes of the total torque from each cylinder are respectively

\begin{equation}\label{eqn:couetteFlow:1210}
\Btau_1 =
%2 \pi r^2 \Delta z \mu \left( a - \frac{b}{r^2} \right)
\frac{2 \pi r^2 \Delta z \mu}{R_2^2 - R_1^2}
\left(
R_2^2 \Omega_2 - R_1^2 \Omega_1
+\frac{R_1^2 R_2^2}{r^2} (\Omega_2 -\Omega_1)
\right) \zcap.
\end{equation}
\begin{equation}\label{eqn:couetteFlow:1230}
\Btau_2 =
%- 2 \pi r^2 \Delta z \mu \left( a - \frac{b}{r^2} \right)
-\frac{2 \pi r^2 \Delta z \mu}{R_2^2 - R_1^2}
\left(
R_2^2 \Omega_2 - R_1^2 \Omega_1
+\frac{R_1^2 R_2^2}{r^2} (\Omega_2 -\Omega_1)
\right) \zcap.
\end{equation}

As expected these torques on the fluid sum to zero

\begin{equation}\label{eqn:couetteFlow:1250}
\Btau_2 + \Btau_1 = 0.
\end{equation}

Evaluating these at \(R_1\) and \(R_2\) respectively gives us the torques on the fluid by the cylinders.  However, we want the torques on the cylinders by the fluid, so have to flip the signs.  For the inner cylinder the total torque on a strip of width \(\Delta z\) by the fluid is


\begin{dmath}\label{eqn:couetteFlow:1270}
\text{Torque on inner cylinder (1) by the fluid}
=
%-(2 \pi R_1^2) \Delta z \mu \left( a - \frac{b}{R_1^2} \right).
-\frac{2 \pi R_1^2 \Delta z \mu}{R_2^2 - R_1^2}
\left(
R_2^2 \Omega_2 - R_1^2 \Omega_1
+\frac{R_1^2 R_2^2}{R_1^2} (\Omega_2 -\Omega_1)
\right)
=
\frac{2 \pi R_1^2 \Delta z \mu}{R_2^2 - R_1^2}
\left(
-2 R_2^2 \Omega_2 + (R_1^2 + R_2^2) \Omega_1
\right).
\end{dmath}

For the outer cylinder the total torque on a strip of width \(\Delta z\) by the fluid is


\begin{dmath}\label{eqn:couetteFlow:1290}
\text{Torque on outer cylinder (2) by the fluid}
=
%(2 \pi R_2^2) \Delta z \mu \left( a - \frac{b}{R_2^2} \right).
\frac{2 \pi R_2^2 \Delta z \mu}{R_2^2 - R_1^2}
\left(
R_2^2 \Omega_2 - R_1^2 \Omega_1
+\frac{R_1^2 R_2^2}{R_2^2} (\Omega_2 -\Omega_1)
\right)
=
\frac{2 \pi R_2^2 \Delta z \mu}{R_2^2 - R_1^2}
\left(
-2 R_1^2 \Omega_1 + (R_1^2 + R_2^2) \Omega_2
\right).
\end{dmath}

%\unnumberedSubsection{Plotting the solutions}
Here is some plots of the velocities at different values for the outer cylinder angular velocity

%\cref{fig:couetteFlow:couetteFlowFig2}.
\imageFigure{../../figures/phy454/couetteFlowFig2}{Couette flow plot}{fig:couetteFlow:couetteFlowFig2}{0.2}
%\cref{fig:couetteFlow:couetteFlowFig3}.
\imageFigure{../../figures/phy454/couetteFlowFig3}{Couette flow plot}{fig:couetteFlow:couetteFlowFig3}{0.2}
%\cref{fig:couetteFlow:couetteFlowFig4}.
\imageFigure{../../figures/phy454/couetteFlowFig4}{Couette flow plot}{fig:couetteFlow:couetteFlowFig4}{0.2}
%\cref{fig:couetteFlow:couetteFlowFig5}.
\imageFigure{../../figures/phy454/couetteFlowFig5}{Couette flow plot}{fig:couetteFlow:couetteFlowFig5}{0.2}

\FIXME{
animation removed.  Was this one on youtube?  Put there and link.
For Acrobat viewers of this document,
An animation of the above is available at
%\cref{fig:couetteFlow:couetteFlowFig6}
}

%\movieFigure{couetteFlowFig6.mp4}{Animation of Couette flow, with continuous variation of outer angular velocity}{fig:couetteFlow:couetteFlowFig6}{width=320pt,height=240pt}

These were all generated from the Mathematica workbook (\nbref{couetteFlow.cdf}), which has some slider controls that can be used to play with the radii and angular velocities in an interactive fashion.

\FIXME{Could graph pressure and torques too}

} % end answer
