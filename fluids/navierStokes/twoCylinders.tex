%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\makeoproblem{Flow between infinite cylinders, one moving}{problem:fluids:twoCylinders}
{2009 phy1530 final}
{
An infinite cylinder of radius \(R_1\) is moving with velocity \(v\) parallel to its axis.  It is placed inside another cylinder of radius \(R_2\).  The axes of the two cylinders coincide.  The fluid is incompressible, with viscosity \(\mu\) and density \(\rho\), the flow is assumed to be stationary, and no external pressure gradient is applied.

\makesubproblem{Find and sketch the velocity field of the fluid between the cylinders}{problem:fluids:twoCylinders:1}
\makesubproblem{Find the friction force per unit length acting on each cylinder}{problem:fluids:twoCylinders:2}
\makesubproblem{Find and sketch the pressure field of the liquid}{problem:fluids:twoCylinders:3}
\makesubproblem{If an external pressure gradient is present, how do you think your answer will change?  Sketch your expectation for the velocity and pressure in this case}{problem:fluids:twoCylinders:4}
} % makeoproblem

\makeanswer{problem:fluids:twoCylinders}{
\makesubanswer{Velocity}{problem:fluids:twoCylinders:1}
We would like to find the velocity and pressure.  Let us start with the illustration of \cref{fig:twoCylinder:twoCylinderFig1} to fix coordinates.

\imageFigure{../../figures/phy454/twoCylinderFig1}{Coordinates for flow between two cylinders}{fig:twoCylinder:twoCylinderFig1}{0.3}

We will assume that we can find a solution of the following form

\begin{subequations}
\begin{equation}\label{eqn:twoCylinder:10}
\Bu = w(r) \zcap
\end{equation}
\begin{equation}\label{eqn:twoCylinder:30}
p = p(r).
\end{equation}
\end{subequations}

We will also work in cylindrical coordinates where our gradient is

\begin{equation}\label{eqn:twoCylinder:50}
\spacegrad = \rcap \partial_r + \frac{\phicap}{r} \partial_\phi + \zcap \partial_z.
\end{equation}

Let us look at the various terms of the Navier-Stokes equation.  Our non-linear term is

\begin{equation}\label{eqn:twoCylinder:70}
\Bu \cdot \spacegrad \Bu = w \partial_z ( w(r) \zcap ) = 0,
\end{equation}

Our Laplacian term is

\begin{equation}\label{eqn:twoCylinders:610}
\begin{aligned}
\mu \spacegrad^2 \Bu
&= \mu \left( \inv{r} \partial_r ( r \partial_r ) + \inv{r^2} \partial_{\phi\phi} + \partial_{z z} \right) w(r) \zcap \\
&=
\frac{\mu}{r} ( r w' )' \zcap.
\end{aligned}
\end{equation}

Putting the pieces together we have

\begin{equation}\label{eqn:twoCylinder:90}
0 = - \rcap p' + \frac{\mu}{r} (r w')' \zcap.
\end{equation}

Decomposing these into one equation for each component we have

\begin{equation}\label{eqn:twoCylinder:110}
p' = 0,
\end{equation}

and

\begin{equation}\label{eqn:twoCylinder:130}
(r w')' = 0.
\end{equation}

Integrating once

\begin{equation}\label{eqn:twoCylinder:170}
r w' = A,
\end{equation}

Short of satisfying our boundary value constraints our velocity is

\begin{equation}\label{eqn:twoCylinder:190}
w = A \ln r + B.
\end{equation}

Our boundary value conditions are given by

\begin{equation}\label{eqn:twoCylinder:210}
\begin{aligned}
w(R_2) &= 0 \\
w(R_1) &= v,
\end{aligned}
\end{equation}

so our integration constants are given by

\begin{equation}\label{eqn:twoCylinder:230}
\begin{aligned}
0 &= A \ln R_2 + B \\
v &= A \ln R_1 + B.
\end{aligned}
\end{equation}

Taking differences we have got

\begin{equation}\label{eqn:twoCylinder:250}
v = A \ln( R_1/R_2 ).
\end{equation}

So our constants are

\begin{subequations}
\begin{equation}\label{eqn:twoCylinder:270}
A = \frac{v}{ \ln( R_1/R_2 ) }
\end{equation}
\begin{equation}\label{eqn:twoCylinder:290}
B = -\frac{v \ln R_2}{ \ln( R_1/R_2 ) },
\end{equation}
\end{subequations}

and

\boxedEquation{eqn:twoCylinder:310}{
w(r) = \frac{ v \ln (r/R_2) }{ \ln( R_1/R_2 ) }.
}

A plot of this function can be found in \cref{fig:twoCylinder:twoCylinderFig2}, and the Mathematica notebook (\nbref{twoCylinders.cdf}).  That notebook has some slider controls that can be used interactively.
\FIXME{upload to youtube and link:
  A sample animation of that interactive capability is available at
%included in \cref{fig:twoCylinders:twoCylindersFig3}.
}

\imageFigure{../../figures/phy454/twoCylinderFig2}{Velocity plot due to inner cylinder dragging fluid along with it}{fig:twoCylinder:twoCylinderFig2}{0.2}

%\movieFigure{twoCylindersFig3.mp4}{Animating the two cylinder velocity field for a set of parameter values}{fig:twoCylinders:twoCylindersFig3}{width=298pt,height=320pt}

\makesubanswer{Frictional forces}{problem:fluids:twoCylinders:2}
For the frictional force per unit area on the fluid by the inner cylinder we have

\begin{equation}\label{eqn:twoCylinders:630}
\begin{aligned}
(\Bsigma \cdot \rcap ) \cdot \zcap
&=
-p \rcap \cdot \zcap +
2 \mu \inv{2} \left(
\PD{r}{u_z}
+\cancel{\PD{z}{u_r}}
\right) \\
&=
\mu v \frac{\ln r }{\ln (R_1/R_2) }
\end{aligned}
\end{equation}

So the forces on the inner and outer cylinders for a strip of width \(\Delta z\) is

\begin{subequations}
\begin{equation}\label{eqn:twoCylinder:330}
\text{frictional force on inner cylinder}
= -2 \pi R_1 \Delta z \mu v \zcap \frac{\ln R_1 }{\ln (R_1/R_2) }
\end{equation}
\begin{equation}\label{eqn:twoCylinder:350}
\text{frictional force on inner cylinder}
=
2 \pi R_2 \Delta z \mu v \zcap \frac{\ln R_2 }{\ln (R_1/R_2) }
\end{equation}
\end{subequations}

\makesubanswer{Pressure}{problem:fluids:twoCylinders:3}
From \eqnref{eqn:twoCylinder:110} the pressure can be trivially solved

\begin{equation}\label{eqn:twoCylinder:150}
p(r) = \text{constant},
\end{equation}

\makesubanswer{With external pressure gradient}{problem:fluids:twoCylinders:4}
With an external pressure gradient imposed we expect a superposition of a parabolic flow profile with what we have calculated above.  With

\begin{equation}\label{eqn:twoCylinder:370}
G = - \frac{dp}{dz},
\end{equation}

our Navier-Stokes equation will now take the form

\begin{equation}\label{eqn:twoCylinder:390}
0 = - \rcap p' - (-G \zcap) + \frac{\mu}{r} (r w')' \zcap.
\end{equation}

We want to solve the LDE

\begin{equation}\label{eqn:twoCylinder:410}
- \frac{ G r}{\mu} =
(r w')' = r w'' + w'
\end{equation}

The homogeneous portion of this equation

\begin{equation}\label{eqn:twoCylinder:430}
(r w')' = 0,
\end{equation}

we have already solved finding \(w = C \ln r + D\).  It looks reasonable to try a polynomial solution for the specific solution.  Let us try a second order polynomial

\begin{subequations}
\begin{equation}\label{eqn:twoCylinder:450}
w = A r^2 + B r
\end{equation}
\begin{equation}\label{eqn:twoCylinder:470}
w' = 2 A r + B
\end{equation}
\begin{equation}\label{eqn:twoCylinder:490}
w'' = 2 A.
\end{equation}
\end{subequations}

We need

\begin{equation}\label{eqn:twoCylinder:510}
-\frac{G r}{\mu} = 2 A r + 2 A r + B,
\end{equation}

So \(B = 0\) and \(4 A = -G/\mu\), and our general solution has the form

\begin{equation}\label{eqn:twoCylinder:530}
w = -\frac{G}{4 \mu} r^2 + C \ln r + D.
\end{equation}

requiring just the boundary condition fitting.  Let us tweak the constants slightly, writing

\begin{equation}\label{eqn:twoCylinder:550}
w = \frac{G}{4 \mu} (R_2^2 - r^2) + C \ln r/R_2 + D,
\end{equation}

so that \(D = 0\) falls out of the \(w(R_2) = 0\) constraint.  Our last integration constant is then determined by the solution of

\begin{equation}\label{eqn:twoCylinder:570}
v = \frac{G}{4 \mu} (R_2^2 - R_1^2) + C \ln R_1/R_2.
\end{equation}

Or

\boxedEquation{eqn:twoCylinder:590}{
w = \frac{G}{4 \mu} (R_2^2 - r^2) +
\left(v - \frac{G}{4 \mu} (R_2^2 - R_1^2)\right)
\frac{\ln r/R_2}{\ln R_1/R_2}.
}

A plot of this, with a pressure gradient small enough that we still see the logarithmic profile is shown in \cref{fig:twoCylinder:twoCylinderFig4}.  An animation of this with different values for \(R_1\), \(v\), and \(G/4\mu\) is available on \youtubehref{BNgpnYeRpLo}, but the Mathematica notebook above can also be used.

\imageFigure{../../figures/phy454/twoCylinderFig4}{Pressure gradient added}{fig:twoCylinder:twoCylinderFig4}{0.2}

% Too big and two slow to embed:
%\cref{fig:twoCylinders:twoCylindersFig5}.
%\movieFigure{twoCylindersFig5.flv}{5: FIXME: CAPTION}{fig:twoCylinders:twoCylindersFig5}{width=320pt,height=240pt}

Even cooler is to look at some plots of the velocity profiles in 3D

%\cref{fig:twoCylinders:twoCylindersFig6}.
\imageFigure{../../figures/phy454/twoCylindersFig6}{3D plot 1}{fig:twoCylinders:twoCylindersFig6}{0.3}
%\cref{fig:twoCylinders:twoCylindersFig7}.
\imageFigure{../../figures/phy454/twoCylindersFig7}{3D plot 2}{fig:twoCylinders:twoCylindersFig7}{0.3}
%\cref{fig:twoCylinders:twoCylindersFig8}.
\imageFigure{../../figures/phy454/twoCylindersFig8}{3D plot 3}{fig:twoCylinders:twoCylindersFig8}{0.3}
%\cref{fig:twoCylinders:twoCylindersFig9}.
\imageFigure{../../figures/phy454/twoCylindersFig9}{3D plot 4}{fig:twoCylinders:twoCylindersFig9}{0.3}

An animation of this can be found at \youtubehref{OiJTopWx7L8} from (\nbref{twoCylinders3D.cdf}).  That notebook is now also available online on the Wolfram demonstrations project \citep{wolframdemo:3DcylinderFlow}.

%\movieFigure{twoCylindersFig11ve.mp4}{FIXME: CAPTION}{fig:twoCylindersFig11ve:twoCylindersFig11ve}{width=746pt,height=608pt}
%\movieFigure{twoCylindersFig11m.mp4}{FIXME: CAPTION}{fig:twoCylindersFig11m:twoCylindersFig11m}{width=546pt,height=408pt}
%\movieFigure{twoCylindersFig11f.mp4}{FIXME: CAPTION}{fig:twoCylindersFig11f:twoCylindersFig11f}{width=546pt,height=408pt}
%\movieFigure{twoCylindersFig11a.mp4}{FIXME: CAPTION}{fig:twoCylindersFig11a:twoCylindersFig11a}{width=546pt,height=412pt}

} % end answer
