%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\makeoproblem{Surface for spinning bucket of water}{problem:fluids:constantSpinSurfaces}
{2019 phy1530 final}
{
Here's a problem that serves as a nice example of how to determine a surface as a function of pressure.  This is something I want to do for the non-bottomless coffee problem, so lets try a simpler version first.

An undergraduate student is assigned a problem about an ideal fluid rotating at a constant angular velocity \(\Omega\) under gravity \(g\).  The velocity field is \(\Bu = (-\Omega y, \Omega x, 0)\).  Here, \(x\) and \(y\) are horizontal and \(z\) points up.  The student is supposed to find the surfaces of constant pressure, and hence the shape of the free surface of water in a rotating bucket.  The free surface corresponds to the surface for which \(p = p_0\), where \(p_0\) is the atmospheric pressure.  Surface tension is neglected.

On their homework assignment, the student writes:

``By Bernoulli's equation:

\begin{equation}\label{eqn:constantSpinSurfaces:10}
B = \frac{p}{\rho} + \inv{2}u^2 + g z
\end{equation}

where \(B\) is a constant.  So the constant pressure surface at \(p = p_0\) is

\begin{equation}\label{eqn:constantSpinSurfaces:30}
z = \left( \frac{B}{g} - \frac{p_0}{\rho g}
\right)
- \frac{\Omega^2 }{2 g} \left( x^2 + y^2 \right).
\end{equation}
''

But this seems to show that the surface of the water in a rotating bucket is \textit{highest in the middle}!

\makesubproblem{What is wrong with the student's argument?}{problem:fluids:constantSpinSurfaces:1}
\makesubproblem{Write down the Euler equations in component form and integrate them directly to find the pressure \(p\), and hence obtain the correct parabolic shape for the free surface}{problem:fluids:constantSpinSurfaces:2}
} % makeoproblem

\makeanswer{problem:fluids:constantSpinSurfaces}{

\makesubanswer{Problem with the argument}{problem:fluids:constantSpinSurfaces:1}

Let us recall how we derived Bernoulli's theorem.  We started with Navier-Stokes and used the identity

\begin{equation}\label{eqn:constantSpinSurfaces:50}
(\Bu \cdot \spacegrad ) \Bu = \spacegrad \inv{2} \Bu^2 + (\spacegrad \cross \Bu) \cross \Bu.
\end{equation}

Navier-Stokes for a steady state incompressible flow, with external body force per unit volume \(\rho \Bg = -\rho \spacegrad \chi\) take the form

\begin{equation}\label{eqn:constantSpinSurfaces:70}
\spacegrad \inv{2} \Bu^2 + (\spacegrad \cross \Bu) \cross \Bu
= -\inv{\rho} \spacegrad p + \nu \spacegrad^2 \Bu - \spacegrad \chi.
\end{equation}

For the non-viscous (``dry-water'') case where we take \(\mu = \nu \rho = 0\), and treat the density \(\rho\) as a constant we find

\begin{equation}\label{eqn:constantSpinSurfaces:90}
\Bu \cross (\spacegrad \cross \Bu)
=
\spacegrad
\left(
\inv{2} \Bu^2 + \frac{p}{\rho} + \chi
\right).
\end{equation}

Observe that we only arrive at Bernoulli's theorem if the flow is also irrotational (as well as incompressible and non-viscous), as we require an irrotational flow where \(\spacegrad \cross \Bu = 0\) to claim that the gradient on the RHS is zero.
%
%The most general claim that we can make, even for irrotational flows is that we have
%
%\begin{equation}\label{eqn:constantSpinSurfaces:110}
%0 = \Bu \cdot
%\spacegrad
%\left(
%\inv{2} \Bu^2 + \frac{p}{\rho} + \chi
%\right).
%\end{equation}
%
%That holds even for flows that are not irrotational, since \(\Bu \cdot (\spacegrad \cross \Bu) = 0\).

In this problem we do not have an irrotational flow, which can be demonstrated by direct calculation.  We have


\begin{dmath}\label{eqn:constantSpinSurfaces:130}
\spacegrad \cross \Bu
=
\Omega
\begin{vmatrix}
\xcap  & \ycap & \zcap \\
\partial_x  &\partial_y  & 0 \\
-y  & x & 0
\end{vmatrix}
=
2 \zcap \Omega
\ne 0
\end{dmath}

In fact we have


\begin{dmath}\label{eqn:constantSpinSurfaces:150}
\Bu \cross (\spacegrad \cross \Bu)
=
2 \Omega^2
\begin{vmatrix}
\xcap  & \ycap  & \zcap \\
-y  & x  & 0  \\
0  & 0  & 1
\end{vmatrix}
=
2 \Omega^2 (\xcap + \ycap)
\end{dmath}

The closest we can get to Bernoulli's theorem for this problem is

\begin{equation}\label{eqn:constantSpinSurfaces:210}
2 \Omega^2 (\xcap + \ycap)
=
\spacegrad
\left(
\inv{2} \Bu^2 + \frac{p}{\rho} + g z
\right).
\end{equation}

We can say that the directional derivatives in directions perpendicular to \(\xcap + \ycap\) are zero, and that


\begin{dmath}\label{eqn:constantSpinSurfaces:230}
2 \Omega^2
= (\partial_x + \partial_y)
\left(
\inv{2} \Bu^2 + \frac{p}{\rho} + g z
\right)
= (\partial_x + \partial_y)
\left(
\inv{2} \Bu^2 + \frac{p}{\rho}
\right)
\end{dmath}

Perhaps those could be used to solve for the surface, but we no longer have something that is obviously integrable.

Because \(\Bu \cdot (\Bu \cross (\spacegrad \cross \Bu)) = 0\), we can also say that


\begin{dmath}\label{eqn:constantSpinSurfaces:250}
0
= \Bu \cdot \spacegrad
\left(
\inv{2} \Bu^2 + \frac{p}{\rho} + g z
\right)
=
\Omega ( y \partial_x - x \partial_y )
\left(
\inv{2} \Bu^2 + \frac{p}{\rho}
\right).
\end{dmath}

Perhaps this could also be used to find the surface?

\paragraph{Streamline interpretation.}

In \citep{landau1987course} we find that Bernoulli's equation applies not only to irrotational flows, but is valid along the streamlines of the flow as well.  The streamlines for this rotating bucket system can be expressed nicely using polar coordinates.  Let


\begin{dmath}\label{eqn:constantSpinSurfaces:251}
\begin{aligned}
x &= \rho \cos\theta \\
y &= \rho \sin\theta
\end{aligned}.
\end{dmath}

The velocity field, plotted in \cref{fig:bucketStreamlines:bucketStreamlinesFig1}, is

\begin{dmath}\label{eqn:constantSpinSurfaces:252}
\Bu = \Omega \rho \lr{ -\sin\theta, \cos\theta, 0}
\end{dmath}

\imageFigure{../../figures/phy454/bucketStreamlinesFig1}{Streamlines for the rotating bucket system.}{fig:bucketStreamlines:bucketStreamlinesFig1}{0.3}

Observe that the cross term \( \Bu \cross \lr{ \spacegrad \cross \Bu} \), are the normals to the streamlines.

\makesubanswer{Solving Navier-Stokes}{problem:fluids:constantSpinSurfaces:2}
Now we want to write down the steady state, incompressible, non-viscous Navier-Stokes equations.  The first of these is trivially satisfied by our assumed solution

\begin{dmath}\label{eqn:constantSpinSurfaces:270}
0
= \spacegrad \cdot \Bu
= \partial_x (-\Omega y) + \partial_y(\Omega x).
\end{dmath}

For the inertial term we have got


\begin{dmath}\label{eqn:constantSpinSurfaces:290}
\Bu \cdot \spacegrad \Bu
=
\Omega^2 (-y \partial_x + x \partial_y (-y, x, 0)
=
\Omega^2 (-x, -y, 0),
\end{dmath}

Leaving us with


\begin{dmath}\label{eqn:constantSpinSurfaces:310}
-\Omega^2 x = -\inv{\rho} \partial_x p
-\Omega^2 y = -\inv{\rho} \partial_y p
          0 = -\inv{\rho} \partial_z p - g
\end{dmath}

Integrating these, we seek seek simultaneous solutions to


\begin{dmath}\label{eqn:constantSpinSurfaces:330}
p = \inv{2} \rho \Omega^2 x^2 + f(y,z)
p = \inv{2} \rho \Omega^2 y^2 + g(x,z)
p = h(x, y) - \rho g z.
\end{dmath}

It is clear that one solution would be

\begin{equation}\label{eqn:constantSpinSurfaces:350}
p = p_0 + \inv{2} \rho \Omega^2 (x^2 + y^2) - \rho g z.
\end{equation}

where \(p_0\) is some constant to be determined, dependent on where we set our origin.  Putting the origin of the coordinate system at the lowest point in the parabolic profile \((x, y, z) = (0, 0, 0)\), we have \(p(0, 0, 0) = p_0\), which fixes \(p_0\) as the atmospheric pressure.  If the radius of the bucket is \(R\), the max height \(h\) of the surface above that point is also found on this surface of constant pressure

\begin{equation}\label{eqn:constantSpinSurfaces:370}
p_0 = p_0 + \inv{2} \rho \Omega^2 R^2 - \rho g h,
\end{equation}

or

\begin{equation}\label{eqn:constantSpinSurfaces:390}
h = \frac{\Omega^2 R^2 }{2 g}.
\end{equation}
} % end answer
