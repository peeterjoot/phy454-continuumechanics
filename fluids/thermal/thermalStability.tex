%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%

%
%
\label{chap:continuumL22}
\section{Thermal stability review.  Rayleigh Benard Problem}

Reading: \S 9.3 from \citep{acheson1990elementary}.

Illustrated in \cref{fig:continuumL22:continuumL22Fig1} is the heated channel we have been discussing

\imageFigure{../../figures/phy454/lec22_Channel_with_heat_applied_to_the_baseFig1}{Channel with heat applied to the base}{fig:continuumL22:continuumL22Fig1}{0.3}

We will take initial conditions

\begin{equation}\label{eqn:continuumL22:10}
\begin{aligned}
\PD{t}{\Bu} &= 0 \\
\PD{t}{T} &= 0
\end{aligned}
\end{equation}

\begin{equation}\label{eqn:continuumL22:30}
\rho \PD{t}{\Bu} + \rho (\Bu \cdot \spacegrad) \Bu = - \spacegrad p + \mu \spacegrad^2 \Bu + \rho \Bg.
\end{equation}

Our energy equation is

\begin{equation}\label{eqn:continuumL22:50}
\PD{t}{T} + (\Bu \cdot \spacegrad) T = \kappa \spacegrad^2 T.
\end{equation}

We have this \(\Bu \cdot \spacegrad\) term because our heat can be carried from one place to the other, due to the fluid motion.  We would not have this convective term for heat dissipation in solids because elements of a solid are not moving around in the bulk.

%We will also use
%
%\begin{equation}\label{eqn:continuumL22:70}
%\spacegrad p_s = \rho_s \Bg
%\end{equation}

In the steady (base) state we have

\begin{equation}\label{eqn:continuumL22:90}
0 = \kappa \spacegrad^2 T =
\kappa \left(
\PDSq{x}{}
+\PDSq{y}{}
+\PDSq{z}{} \right) T,
\end{equation}

but since we are only considering spatial variation with \(z\) we have

\begin{equation}\label{eqn:continuumL22:110}
\kappa \PDSq{z}{} T_s = 0,
\end{equation}

with solution

\begin{equation}\label{eqn:continuumL22:130}
T_s = T_0 - \frac{\Delta T}{d} z.
\end{equation}

We found that after application of the perturbation

\begin{equation}\label{eqn:continuumL22:150}
\begin{aligned}
\Bu &\rightarrow 0 + \delta \Bu \\
p &\rightarrow p_s + \delta p \\
\rho &\rightarrow \rho_s + \delta \rho \\
T &\rightarrow T_s + \delta T
\end{aligned}
\end{equation}

to the base state equations, our perturbed Navier-Stokes equation was

\begin{equation}\label{eqn:continuumL22:170}
\spacegrad^2 \left( \PD{t}{} - \nu \spacegrad^2 \right) \delta w = g \alpha
\left(
\PDSq{x}{}
+\PDSq{y}{}
\right)
\delta T.
\end{equation}

\section{Application of the perturbation to the energy equation}

\begin{equation}\label{eqn:continuumL22:190}
\PD{t}{T_s + \delta T} + (\delta \Bu \cdot \spacegrad) (T_s + \delta T) = \kappa \spacegrad^2 (T_s + \delta T)
\end{equation}

We have got

\begin{equation}\label{eqn:continuumL22:210}
\PD{t}{T_s} = 0.
\end{equation}

Using this, and \eqnref{eqn:continuumL22:110}, and neglecting any terms of second order smallness we have

\boxedEquation{eqn:continuumL22:230}{
\PD{t}{\delta T} + \delta \Bu \cdot \spacegrad T_s = \kappa \spacegrad^2 \delta T.
}

We would like to solve this and \eqnref{eqn:continuumL22:170} simultaneously.

\section{Non-dimensionalisation of the thermal velocity equation}

We would like to scale

\begin{equation}\label{eqn:continuumL22:250}
\begin{array}{l l}
x,y,z & \quad \mbox{with \(d\)} \\
t & \quad \mbox{with \(d^2/\nu\)} \\
\delta w & \quad \mbox{with \(\kappa/d\)} \\
\delta T & \quad \mbox{with \(\Delta T\)}
\end{array}
\end{equation}

Sanity check of dimensions

\begin{itemize}
\item viscosity dimensions
\begin{equation}\label{eqn:continuumL22:270}
[\nu] \sim \left[ \frac{1}{\text{T}} \right]/ \left[\inv{\text{L}^2} \right] \sim \frac{\text{L}^2}{\text{T}},
\end{equation}
\item thermal conductivity dimensions

Since \([ \kappa \spacegrad^2 ] \sim 1/\text{T}\), we have

\begin{equation}\label{eqn:continuumL22:610}
[ \kappa ] \sim \frac{\text{L}^2}{\text{T}}
\end{equation}

\item time scaling

\begin{equation}\label{eqn:continuumL22:290}
\left[\frac{d^2}{\nu}\right] \sim \frac{\text{L}^2}{\text{L}^2 \text{T}^{-1}} \sim \text{T}.
\end{equation}

\item velocity scaling

\begin{equation}\label{eqn:continuumL22:630}
[\kappa/d] \sim \frac{\text{L}^2}{\text{T}} \inv{\text{L}} \sim [\delta w]
\end{equation}

\end{itemize}

Looks like everything checks out.

Let us apply this rescaling to our perturbed velocity \eqnref{eqn:continuumL22:170}

\begin{equation}\label{eqn:continuumL22:310}
{\spacegrad'}^2 \left(
\frac{\nu}{d^2} \PD{t'}{} - \frac{\nu}{d^2} {\spacegrad'}^2
\right)
\frac{\kappa}{d}
\delta w'
=
g \alpha \Delta T
\left(
\PDSq{x'}{}
+\PDSq{y'}{}
\right) \delta T'.
\end{equation}

Introducing the \textit{Rayleigh number}

\begin{equation}\label{eqn:continuumL22:330}
\calR = \frac{g \alpha \Delta T d^3}{\nu \kappa},
\end{equation}

and dropping primes, we have

\boxedEquation{eqn:continuumL22:310b}{
\spacegrad^2 \left(
\PD{t}{} - \spacegrad^2
\right)
\delta w
=
\calR \left(
\PDSq{x}{}
+\PDSq{y}{}
\right) \delta T.
}

My class notes original had \(\calR\) with the value

\begin{equation*}
\frac{g \Delta T d^2}{\nu \alpha},
\end{equation*}

but performing this non-dimensionalization shows that this was either quoted incorrectly, or typed wrong in the heat of the moment.  A check against the text shows (equation (9.27)), shows that \eqnref{eqn:continuumL22:330} is correct.

\section{Non-dimensionalization of the energy equation}

Rescaling our energy \eqnref{eqn:continuumL22:230} we find

\begin{equation}\label{eqn:continuumL22:230b}
\frac{\nu}{d^2} \PD{t'}{\delta T'} + \frac{\kappa}{d^2} \delta \Bu' \cdot \spacegrad' T_s' = \frac{\kappa}{d^2} {\spacegrad'}^2 \delta T'.
\end{equation}

Introducing the \textit{Prandtl number}

\begin{equation}\label{eqn:continuumL22:370}
\text{P}_r = \frac{\nu}{\kappa},
\end{equation}

and dropping primes our non-dimensionalized energy equation takes the form

\boxedEquation{eqn:continuumL22:350}{
\left(
\text{P}_r
\PD{t}{} - \spacegrad^2 \right) \delta T = \delta w.
}

\section{Normal mode analysis}

We have got a pair of nasty looking coupled equations \eqnref{eqn:continuumL22:310b}, and \eqnref{eqn:continuumL22:350}.  Repeated so that we can see them together

\begin{subequations}
\begin{equation}\label{eqn:continuumL22:650}
\spacegrad^2 \left( \PD{t}{} - \spacegrad^2 \right) \delta w = \calR \left( \PDSq{x}{} +\PDSq{y}{} \right) \delta T
\end{equation}
\begin{equation}\label{eqn:continuumL22:670}
\left( \text{P}_r \PD{t}{} - \spacegrad^2 \right) \delta T = \delta w,
\end{equation}
\end{subequations}

it is clear that we can decouple these by inserting \eqnref{eqn:continuumL22:670} into \eqnref{eqn:continuumL22:650}.  Doing that gives us a beastly 6th order spatial equation for the perturbed temperature

\begin{equation}\label{eqn:continuumL22:690}
\left( \PD{t}{} - \spacegrad^2 \right) \left( \text{P}_r \PD{t}{} - \spacegrad^2 \right) \spacegrad^2 \delta T = \calR \left( \PDSq{x}{} +\PDSq{y}{} \right) \delta T.
\end{equation}

It is pointed out in the text we have all the \(x\) and \(y\) derivatives coming together we can apply separation of variables with

\begin{equation}\label{eqn:continuumL22:710}
\delta T = \Theta(z) f(x, y) e^{\sigma t},
\end{equation}

provided we introduce some restrictions on the form of \(f(x, y)\).  Here \(\sigma\) (if real) is the growth rate.  Applying the Laplacian to this assumed solution we find

\begin{equation}\label{eqn:continuumL22:730}
\spacegrad^2 \delta T = e^{\sigma t} \left( \Theta''(z) f(x, y) +\Theta(z) \spacegrad_t^2 f(x, y) \right),
\end{equation}

where

\begin{equation}\label{eqn:continuumL22:750}
\spacegrad_t^2 = \PDSq{x}{} +\PDSq{y}{}.
\end{equation}

For \eqnref{eqn:continuumL22:730} to be separable we require a constant proportionality

\begin{equation}\label{eqn:continuumL22:770}
\spacegrad_t^2 f(x, y) \propto f(x, y),
\end{equation}

or

\begin{equation}\label{eqn:continuumL22:790}
\spacegrad_t^2 f(x, y) \pm k^2 f(x, y) = 0.
\end{equation}

Picking \(+ k^2\) so that we do not have hyperbolic solutions, \(f\) must have the form

\begin{equation}\label{eqn:continuumL22:810}
f(x, y) = e^{i (k_x x + k_y y)},
\end{equation}

where

\begin{equation}\label{eqn:continuumL22:830}
k^2 = k_x^2 + k_y^2.
\end{equation}

Our separation of variables function now takes the form

\begin{equation}\label{eqn:continuumL22:850}
\delta T = \Theta(z) e^{ i ( k_1 x + k_2 y) + \sigma t}.
\end{equation}

Writing

\begin{equation}\label{eqn:continuumL22:570}
D = \frac{\partial}{\partial z},
\end{equation}

our beastly equation to solve is then given by

\begin{equation}\label{eqn:thermalStability:1130}
\begin{aligned}
0
&=
\left( \PD{t}{} - \spacegrad_t^2 - D^2 \right) \left( \text{P}_r \PD{t}{} - \spacegrad_t^2 -D^2 \right) \left( \spacegrad_t^2 -D^2 \right)
\Theta(z) e^{ i ( k_1 x + k_2 y) + \sigma t} \\
&\quad - \calR \spacegrad_t^2
\Theta(z) e^{ i ( k_1 x + k_2 y) + \sigma t}
\\
&=
\Bigl( \left( \sigma + k^2 - D^2 \right) \left( \text{P}_r \sigma + k^2 - D^2 \right) \left( -k^2 -D^2 \right) + \calR k^2
\Bigr) \Theta(z) e^{ i ( k_1 x + k_2 y) + \sigma t}
\end{aligned}
\end{equation}

This is now an equation for only \(\Theta(z)\)

\begin{equation}\label{eqn:continuumL22:870}
0 = \Bigl( \left( \sigma + k^2 - D^2 \right) \left( \text{P}_r \sigma + k^2 - D^2 \right) \left( -k^2 -D^2 \right) + \calR k^2
\Bigr) \Theta(z).
\end{equation}

Conceptually we have just a plain old LDE, and should we decide to expand this out we have something of the form

\begin{equation}\label{eqn:continuumL22:890}
0 = \Bigl( \alpha D^6 + \beta D^4 + \gamma D^2 + \zeta \Bigr) \Theta(z).
\end{equation}

Our standard toolbox method to solve this is to assume a solution \(\Theta(z) = e^{m z}\) and compute the characteristic equation.  We would have to solve

\begin{equation}\label{eqn:continuumL22:910}
0 = \alpha m^6 + \beta m^4 + \gamma m^2 + \zeta.
\end{equation}

Let us back up a bit instead.  Looking back to \eqnref{eqn:continuumL22:670}, it is clear that we will have the same separable form for our perturbed velocity since we have

\begin{equation}\label{eqn:continuumL22:670b}
\left( \text{P}_r \sigma + k^2 - D^2 \right) \Theta(z) e^{i (\Bk \cdot \Bx) } e^{\sigma t} = \delta w,
\end{equation}

where

\begin{equation}\label{eqn:continuumL22:930}
\Bk = (k_x, k_y, 0).
\end{equation}

Assuming a solution of the form

\begin{equation}\label{eqn:continuumL22:950}
\delta w = w(z) e^{ i ( k_1 x + k_2 y) + \sigma t},
\end{equation}

our velocity is then fully specified in terms of the temperature, since we have

\begin{equation}\label{eqn:continuumL22:970}
w(z) = \left( \text{P}_r \sigma + k^2 - D^2 \right) \Theta(z).
\end{equation}

\section{Back to our coupled equations}

Having gleamed an idea what the form of our solutions is, we can simplify our original coupled system, writing

\begin{subequations}
\label{eqn:continuumL22:990a}
\begin{equation}\label{eqn:continuumL22:990}
(D^2 - k^2) ( \sigma - (D^2 - k^2) ) w(z) = -\calR k^2 \Theta(z)
\end{equation}
\begin{equation}\label{eqn:continuumL22:1010}
(D^2 - k^2 -\text{P}_r \sigma ) \Theta(z) = -w(z).
\end{equation}
\end{subequations}

Considering the boundary conditions, if the heating is even then at \(z = t = 0\) we can not have any variation with \(x\) and \(y\), so can only have \(\Theta(0) = 0\).  Thus at the boundary, from \eqnref{eqn:continuumL22:990}, we have

\begin{equation}\label{eqn:continuumL22:1030}
0 = \evalbar{(D^2 - k^2) ( \sigma - (D^2 - k^2) ) w(z)}{z = 0}.
\end{equation}

From the continuity equation \(\spacegrad \cdot \Bu = 0\), the text argues that we also have \(\PDi{z}{\delta w} = 0\) on the boundary, so that on that plane we also have

\begin{equation}\label{eqn:continuumL22:1050}
0 = \evalbar{w(z) = D w(z)}{z = 0}.
\end{equation}

Expanding out \eqnref{eqn:continuumL22:1030} then gives us

\begin{equation}\label{eqn:continuumL22:1070}
0 = \evalbar{(D^4 - D^2 ( 2 k^2 + \sigma ) + k^2(\sigma + k^2))w}{z = 0}.
\end{equation}

or
\begin{equation}\label{eqn:continuumL22:1070b}
0 = \evalbar{(D^4 - D^2 ( 2 k^2 + \sigma ))w}{z = 0}.
\end{equation}

These boundary value constraints \eqnref{eqn:continuumL22:1050}, and \eqnref{eqn:continuumL22:1070b}, plus the coupled system equations \eqnref{eqn:continuumL22:990a} are the complete problem to solve.  To get a feel for the solution of this system, consider the system with the following simpler set of boundary value constraints

\begin{equation}\label{eqn:continuumL22:590}
\evalbar{w = D^2 w = D^4 w}{z = 0, 1} = 0,
\end{equation}

which in the text is described as the artificial problem of thermal instability for boundaries that are stress free.
\FIXME{it is not clear to me what that means without some thought ... return to this}
For such a system on the boundaries \(z = 0, 1\) (noting that we are still in dimensionless quantities), we have solutions

\begin{equation}\label{eqn:continuumL22:470}
\begin{aligned}
w(z) &= A_n \sin\left( n \pi z \right) \\
\Theta(z) &= B_n \sin\left( n \pi z \right).
\end{aligned}
\end{equation}

Note that we have

\begin{equation}\label{eqn:continuumL22:1090}
(D^2 - k^2)
\sin\left( n \pi z \right).
 = \left( -\left( n \pi \right)^2 - k^2 \right)
\sin\left( n \pi z \right).
\end{equation}

Inserting \eqnref{eqn:continuumL22:470} into our system \eqnref{eqn:continuumL22:990a}, we have

\begin{equation}\label{eqn:continuumL22:1110}
\begin{aligned}
\left( -\left( n \pi \right)^2 - k^2 \right)
\left( \sigma -
\left( -\left( n \pi \right)^2 - k^2 \right)
\right) A_n
\sin\left( n \pi z \right)
+ \calR k^2 B_n
\sin\left( n \pi z \right)
&= 0 \\
\left( -\left( n \pi \right)^2 - k^2 - \text{P}_r \sigma \right) B_n
\sin\left( n \pi z \right)
+ A_n
\sin\left( n \pi z \right)
&= 0
\end{aligned}
\end{equation}

For any \(A_n\), \(B_n\), we must then have

\begin{equation}\label{eqn:continuumL22:490}
0 =
\begin{vmatrix}
\left( n^2 \pi^2 + k^2 \right)^2 + \sigma \left( n^2 \pi^2 + k^2\right) & -\calR k^2 \\
-1 & n^2 \pi^2 + k^2 + \text{P}_r \sigma
\end{vmatrix}.
\end{equation}

For \(\sigma = 0\), this gives us the critical value for the Rayleigh number

\begin{equation}\label{eqn:continuumL22:510}
\calR = \frac{(k^2 + n^2 \pi^2)^3}{k^2},
\end{equation}

the value that separates our stable and unstable solutions.  On the other hand for
\begin{itemize}
\item \(\Real(\sigma) > 0\) (\(\Delta T > \Delta T_e\)), we have an instable system.
\item \(\Real(\sigma) < 0\) (\(\Delta T > \Delta T_e\)), we have a stable system.
\end{itemize}

This is illustrated in \cref{fig:continuumL22:continuumL22Fig2}.

\imageFigure{../../figures/phy454/lec22_Critical_Rayleighs_numberFig2}{Critical Rayleigh's number}{fig:continuumL22:continuumL22Fig2}{0.3}

The instability means that we will have instable flows as illustrated in \cref{fig:continuumL22:continuumL22Fig3}.

\imageFigure{../../figures/phy454/lec22_Instability_due_to_heatingFig3}{Instability due to heating}{fig:continuumL22:continuumL22Fig3}{0.2}

Solving for these critical points we find

\begin{subequations}
\begin{equation}\label{eqn:continuumL22:530}
k_e^2 = \frac{\pi^2}{2}
\end{equation}
\begin{equation}\label{eqn:continuumL22:550}
\calR_e = \frac{27 \pi^4}{4}
\end{equation}
\end{subequations}

\section{Multimedia presentations}

\begin{itemize}
\item Kelvin-Helmholtz instability.

Colored salt water underneath, with unsalted water on top.  Apparatus tilted causing flow of one over the other.  Instability of the interface.

See \citep{wiki:KelvinHelmholtz} for a really cool animation of a simulation of this effect.  It ends up looking very fractal.  Also interesting is the picture of this observed for real in the atmosphere of Saturn.

\item A simulated mushroom cloud occurring with one fluid seeping into another.  This looks it matches what we find under Rayleigh-Taylor instability in \citep{wiki:RayleighTaylor}.

\item plume, motion up through a denser fluid.

\item Plateau-Rayleigh instability.  Drop pinching off.  See instability in the fluid channel feeding the drop.  A crude illustration of this can be found in \cref{fig:continuumL22:continuumL22Fig4}.

\imageFigure{../../figures/phy454/lec22_Crude_illustration_of_instability_leading_to_a_drop_pinching_offFig4}{Crude illustration of instability leading to a drop pinching off}{fig:continuumL22:continuumL22Fig4}{0.2}

A better illustrations (and animations) can be found in \citep{wiki:PlateauRayleigh}.

\item Jet of water injected into a rotating tub on a turntable.  Jet forms and surfaces.

\end{itemize}
